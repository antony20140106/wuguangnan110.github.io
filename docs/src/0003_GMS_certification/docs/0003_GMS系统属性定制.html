<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>wugn</title>

      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/translations.js"></script>
        <script src="../../../_static/js/baidutongji.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> wugn_note
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">简介</a><ul>
<li><a class="reference internal" href="#id2">参考</a></li>
<li><a class="reference internal" href="#id3">概述</a></li>
<li><a class="reference internal" href="#boradid">硬件boradid信息</a><ul>
<li><a class="reference internal" href="#m50">M50项目</a></li>
<li><a class="reference internal" href="#m8">M8项目</a></li>
</ul>
</li>
<li><a class="reference internal" href="#rc">RC平台化</a></li>
<li><a class="reference internal" href="#id4">rc定制属性类型</a></li>
<li><a class="reference internal" href="#id5">RC属性定义</a><ul>
<li><a class="reference internal" href="#ro-product">1.ro.product定义</a><ul>
<li><a class="reference internal" href="#id6">1.1 ro.product属性初始化赋值</a></li>
<li><a class="reference internal" href="#id7">1.2ro.product重新赋值</a></li>
</ul>
</li>
<li><a class="reference internal" href="#ro-product-odm-product-system-vendor-system-ext-device-model-name">ro.product.{odm/product/system/vendor/system_ext}.{device/model/name}定义</a><ul>
<li><a class="reference internal" href="#build-prop">1.首先看看build.prop里面的内容</a></li>
<li><a class="reference internal" href="#id8">2. build.prop生成过程</a><ul>
<li><a class="reference internal" href="#system-build-prop">system/build.prop生成过程</a></li>
</ul>
</li>
<li><a class="reference internal" href="#vendor-build-prop">3.vendor/build.prop生成过程</a></li>
</ul>
</li>
<li><a class="reference internal" href="#fingerprint">fingerprint属性定制</a></li>
</ul>
</li>
<li><a class="reference internal" href="#id9">总结</a></li>
</ul>
</li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">wugn_note</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs"> 
<li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
<li>简介</li>
<li style="float: right;margin-left: 10px;"><a href="javascript:history.forward()">Forward</a></li>
<li style="float: right;margin-left: 10px;"><a href="javascript:history.back()">Go Back</a> | </li>
<li style="float: right;margin-left: 10px;"><a href="/index.html">Home</a> | </li>

      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="id1">
<h1>简介<a class="headerlink" href="#id1" title="此标题的永久链接"></a></h1>
<p>GMS相关属性定制</p>
<section id="id2">
<h2>参考<a class="headerlink" href="#id2" title="此标题的永久链接"></a></h2>
<p><a class="reference external" href="https://www.cnblogs.com/pngcui/p/7193622.html">Android之build.prop属性详解</a></p>
</section>
<section id="id3">
<h2>概述<a class="headerlink" href="#id3" title="此标题的永久链接"></a></h2>
<p>目前MTK平台有两个项目，M8和M50，需要共用同一套代码，需要从RC、kernel、lk三个方面做产品兼容。</p>
<ul class="simple">
<li><p>参考A35平台</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">shell</span>
<span class="n">MAG_CARD</span><span class="o">=</span><span class="s2">&quot;05&quot;</span>
<span class="n">IC_CARD</span><span class="o">=</span><span class="s2">&quot;00&quot;</span>   
<span class="n">SAM_NUM</span><span class="o">=</span><span class="s2">&quot;02&quot;</span>
<span class="n">ETHERNET</span><span class="o">=</span><span class="s2">&quot;03&quot;</span>            
<span class="n">TOUCH_SCREEN</span><span class="o">=</span><span class="s2">&quot;158&quot;</span>      
<span class="n">LCD</span><span class="o">=</span><span class="s2">&quot;158&quot;</span>               
<span class="n">WIFI</span><span class="o">=</span><span class="s2">&quot;30&quot;</span>               
<span class="n">CAMERA_NUMBER</span><span class="o">=</span><span class="s2">&quot;01&quot;</span>
<span class="n">CAMERA_FRONT</span><span class="o">=</span><span class="s2">&quot;46&quot;</span>       
<span class="n">MAIN_BOARD</span><span class="o">=</span><span class="s2">&quot;V01&quot;</span>
<span class="n">PORT_BOARD</span><span class="o">=</span><span class="s2">&quot;V01&quot;</span>
<span class="n">PN</span><span class="o">=</span><span class="s2">&quot;A35-0NA-RD6-02AA&quot;</span>
<span class="n">CONFIG_FILE_VER</span><span class="o">=</span><span class="s2">&quot;V1.0&quot;</span>
<span class="n">RF_1356M</span><span class="o">=</span><span class="s2">&quot;03&quot;</span>            
<span class="n">RF_PARA_1</span><span class="o">=</span><span class="s2">&quot;00000FFF0404107F1000&quot;</span>
<span class="n">RF_PARA_2</span><span class="o">=</span><span class="s2">&quot;7F3C0B0B020300000000&quot;</span>
<span class="n">RF_PARA_3</span><span class="o">=</span><span class="s2">&quot;00000000000000000000&quot;</span>
<span class="n">TERMINAL_NAME</span><span class="o">=</span><span class="s2">&quot;A35&quot;</span> 
</pre></div>
</div>
<ul class="simple">
<li><p>设备上电的时候，sp会通过串口发送以上配置文件给ap，u-boot需要解析出这些参数，并放到bootargs中，然后传送给kernel。</p></li>
<li><p>需要注意的是：TERMINAL_NAME表示产品名称， MAIN_BOARD表示主板版本，PORT_BOARD表示副板版本，u-boot会用这3个配置项的组合查找对应的dts，然后启动kernel，例如A35_V01_V01.dts。同理，在android的init进程启动的时候，也会根据这几个参数加载对应的rc文件</p></li>
</ul>
</section>
<section id="boradid">
<h2>硬件boradid信息<a class="headerlink" href="#boradid" title="此标题的永久链接"></a></h2>
<section id="m50">
<h3>M50项目<a class="headerlink" href="#m50" title="此标题的永久链接"></a></h3>
<p><img alt="0003_.png" src="../../../_images/0003_yuanlitu.png" /></p>
</section>
<section id="m8">
<h3>M8项目<a class="headerlink" href="#m8" title="此标题的永久链接"></a></h3>
<p><img alt="0003_boardid.png" src="../../../_images/0003_boardid.png" /></p>
</section>
</section>
<section id="rc">
<h2>RC平台化<a class="headerlink" href="#rc" title="此标题的永久链接"></a></h2>
<ul class="simple">
<li><p>参考A35在rc文件中设置各种手机配置，如下：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">on</span> <span class="n">init</span>
<span class="c1">#机型名称</span>
    <span class="n">setprop</span> <span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">model</span> <span class="n">M50</span>
    <span class="n">setprop</span> <span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span> <span class="n">M50</span>
    <span class="n">setprop</span> <span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">device</span> <span class="n">M50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">board</span> <span class="n">M50</span>
</pre></div>
</div>
<ul class="simple">
<li><p>selinux报错如下：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>简化：
denied { set } for property=ro.product.model pid=332 uid=0 gid=0 scontext=u:r:vendor_init:s0 tcontext=u:object_r:exported2_default_prop:s0 tclass=property_service permissive=0

(210510_16:12:30.721)[    7.987986] &lt;1&gt;.(1)[1:init]init 24: [7959][0]processing action (init) from (/vendor/paxdroid/rc_file/init.mt6762_M50_V0.rc:33)
(210510_16:12:30.721)[    7.990326] &lt;6&gt;.(6)[331:init]init 22: [7961][33]ReapLogF PropSet [sys.usb.configfs]=[0]7905 [hwservicemanager.ready]=[true]7928 Done
(210510_16:12:30.721)[    7.990428] &lt;4&gt;.(4)[369:logd.auditd]type=1107 audit(1620634162.040:6): uid=0 auid=4294967295 ses=4294967295 subj=u:r:init:s0 msg=&#39;avc: denied { set } for property=ro.product.model pid=332 uid=0 gid=0 scontext=u:r:vendor_init:s0 tcontext=u:object_r:exported2_default_prop:s0 tclass=property_service permissive=0&#39;
(210510_16:12:30.721)[    7.991837] &lt;6&gt;.(6)[331:init]init 22: [7961][33]Unable to set property &#39;ro.product.model&#39; from uid:0 gid:0 pid:332: SELinux permission check failed
(210510_16:12:30.721)[    7.998082] &lt;7&gt;.(7)[331:init]init 22: [7969][0]Unable to set property &#39;ro.product.name&#39; from uid:0 gid:0 pid:332: SELinux permission check failed
(210510_16:12:30.721)[    7.998109] &lt;4&gt;.(4)[369:logd.auditd]type=1107 audit(1620634162.048:7): uid=0 auid=4294967295 ses=4294967295 subj=u:r:init:s0 msg=&#39;avc: denied { set } for property=ro.product.name pid=332 uid=0 gid=0 scontext=u:r:vendor_init:s0 tcontext=u:object_r:exported2_default_prop:s0 tclass=property_service permissive=0&#39;
(210510_16:12:30.721)[    8.000575] &lt;7&gt;.(7)[331:init]init 22: [7972][0]Unable to set property &#39;ro.product.device&#39; from uid:0 gid:0 pid:332: SELinux permission check failed
(210510_16:12:30.721)[    8.003390] &lt;2&gt;.(2)[369:logd.auditd]type=1107 audit(1620634162.052:8): uid=0 auid=4294967295 ses=4294967295 subj=u:r:init:s0 msg=&#39;avc: denied { set } for property=ro.product.device pid=332 uid=0 gid=0 scontext=u:r:vendor_init:s0 tcontext=u:object_r:exported2_default_prop:s0 tclass=property_service permissive=0&#39;
(210510_16:12:30.721)[    8.005519] &lt;4&gt;.(4)[331:init]init 22: [7977][0]Unable to set property &#39;ro.product.board&#39; from uid:0 gid:0 pid:332: Read-only property was already set
</pre></div>
</div>
<ul class="simple">
<li><p>但是发现系统报错neverallow：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>修改如下：
set_prop(vendor_init, exported2_default_prop)
set_prop参考：
https://blog.csdn.net/u013398960/article/details/98998653

报错：
system/sepolicy/public/property.te:258
  (neverallow base_typeattr_217 base_typeattr_481 (property_service (set)))

代码如下：
neverallow { coredomain -init } {
  vendor_property_type
  -vendor_public_property_type
}:property_service set;
</pre></div>
</div>
<ul class="simple">
<li><p>发现放到vendor下面行不通，参考A35放到root下面可以避开selinux权限问题。</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">device</span><span class="o">/</span><span class="n">a133</span><span class="o">/</span><span class="n">a133</span><span class="o">.</span><span class="n">mk</span>
<span class="mi">70</span><span class="p">:</span>    <span class="n">paxdroid</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">a133</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">rc</span><span class="p">:</span><span class="n">root</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">rc</span> \
<span class="mi">71</span><span class="p">:</span>    <span class="n">paxdroid</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">a133</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">A35</span><span class="o">.</span><span class="n">rc</span><span class="p">:</span><span class="n">root</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">A35</span><span class="o">.</span><span class="n">rc</span> \
<span class="mi">72</span><span class="p">:</span>    <span class="n">paxdroid</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">a133</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">A660</span><span class="o">.</span><span class="n">rc</span><span class="p">:</span><span class="n">root</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">A660</span><span class="o">.</span><span class="n">rc</span> \
<span class="mi">73</span><span class="p">:</span>    <span class="n">paxdroid</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">a133</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">A660</span><span class="o">.</span><span class="n">rc</span><span class="p">:</span><span class="n">root</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">P100</span><span class="o">.</span><span class="n">rc</span> \
<span class="mi">74</span><span class="p">:</span>    <span class="n">paxdroid</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">a133</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">QR500</span><span class="o">.</span><span class="n">rc</span><span class="p">:</span><span class="n">root</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">QR500</span><span class="o">.</span><span class="n">rc</span> \
<span class="mi">75</span><span class="p">:</span>    <span class="n">paxdroid</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">a133</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">AF5</span><span class="o">.</span><span class="n">rc</span><span class="p">:</span><span class="n">root</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">paxdroid</span><span class="o">.</span><span class="n">AF5</span><span class="o">.</span><span class="n">rc</span> \
<span class="mi">76</span><span class="p">:</span>    <span class="n">paxdroid</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">a133</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">pax</span><span class="o">.</span><span class="n">usb</span><span class="o">.</span><span class="n">rc</span><span class="p">:</span><span class="n">root</span><span class="o">/</span><span class="n">init</span><span class="o">.</span><span class="n">pax</span><span class="o">.</span><span class="n">usb</span><span class="o">.</span><span class="n">rc</span> \
</pre></div>
</div>
</section>
<section id="id4">
<h2>rc定制属性类型<a class="headerlink" href="#id4" title="此标题的永久链接"></a></h2>
<ul class="simple">
<li><p>目前M50需要定制的变量如下：</p></li>
</ul>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>属性</p></th>
<th class="head"><p>说明</p></th>
<th class="head"><p>值</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>ro.build.product</p></td>
<td><p>已经过时，现在使用“ro.product.device”</p></td>
<td><p>值同“ro.product.device”即可 M50</p></td>
</tr>
<tr class="row-odd"><td><p>ro.product.device</p></td>
<td><p>设备名称</p></td>
<td><p>PAYPHONEM50</p></td>
</tr>
<tr class="row-even"><td><p>ro.product.model</p></td>
<td><p>型号名称</p></td>
<td><p>M50</p></td>
</tr>
<tr class="row-odd"><td><p>ro.product.name</p></td>
<td><p>产品名称</p></td>
<td><p>M50</p></td>
</tr>
<tr class="row-even"><td><p>ro.product.board</p></td>
<td><p>采用的底板/处理器</p></td>
<td><p>M50</p></td>
</tr>
<tr class="row-odd"><td><p>ro.product.manufacturer</p></td>
<td><p>制造商名称</p></td>
<td><p>PAX</p></td>
</tr>
</tbody>
</table>
<p>另外还有一些属性如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">odm</span><span class="o">.</span><span class="n">device</span> <span class="n">M50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">odm</span><span class="o">.</span><span class="n">model</span> <span class="n">M50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">odm</span><span class="o">.</span><span class="n">name</span> <span class="n">M50</span>
	
    <span class="n">setprop</span> <span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">device</span> <span class="n">PAYPHONEM50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">model</span> <span class="n">M50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span> <span class="n">M50</span>
	
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">device</span> <span class="n">PAYPHONEM50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">model</span> <span class="n">M50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">name</span> <span class="n">M50</span>
	
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">vendor</span><span class="o">.</span><span class="n">device</span> <span class="n">PAYPHONEM50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">vendor</span><span class="o">.</span><span class="n">model</span> <span class="n">M50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">vendor</span><span class="o">.</span><span class="n">name</span> <span class="n">M50</span>
	
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">system_ext</span><span class="o">.</span><span class="n">device</span> <span class="n">PAYPHONEM50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">system_ext</span><span class="o">.</span><span class="n">model</span> <span class="n">M50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">system_ext</span><span class="o">.</span><span class="n">name</span> <span class="n">M50</span>
</pre></div>
</div>
<p>这些属性分别存在于各自的build.prop,例如ro.product.system.device就存在于<code class="docutils literal notranslate"><span class="pre">/system/build.prop</span></code>路径</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">system</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">prop</span>
<span class="o">./</span><span class="n">system</span><span class="o">/</span><span class="n">system_ext</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">prop</span>
<span class="o">./</span><span class="n">vendor</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">prop</span>
<span class="o">./</span><span class="n">vendor</span><span class="o">/</span><span class="n">odm</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">prop</span>
<span class="o">./</span><span class="n">product</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">prop</span>
</pre></div>
</div>
<p>这些属性的用途是备用的，如下：</p>
<blockquote>
<div><p>If the ro.product.[brand|device|manufacturer|model|name] properties have not been explicitly set, derive them from ro.product.${partition}.* properties</p>
</div></blockquote>
</section>
<section id="id5">
<h2>RC属性定义<a class="headerlink" href="#id5" title="此标题的永久链接"></a></h2>
<section id="ro-product">
<h3>1.ro.product定义<a class="headerlink" href="#ro-product" title="此标题的永久链接"></a></h3>
<ul class="simple">
<li><p>主要包括如下属性：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>    <span class="n">setprop</span> <span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">device</span> <span class="n">PAYPHONEM50</span>
	<span class="n">setprop</span> <span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">model</span> <span class="n">M50</span>
	<span class="n">setprop</span> <span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span> <span class="n">M50</span>
	<span class="n">setprop</span>	<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">board</span> <span class="n">M50</span>
	<span class="n">setprop</span> <span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">manufacturer</span> <span class="n">PAX</span>
</pre></div>
</div>
<ul class="simple">
<li><p>ro.product.name定义如下：<code class="docutils literal notranslate"><span class="pre">device/mediateksample/k62v1_64_pax/k62v1_64_pax.mk</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">name</span><span class="p">:</span>
<span class="n">PRODUCT_NAME</span> <span class="o">:=</span> <span class="n">k62v1_64_pax</span>
</pre></div>
</div>
<ul class="simple">
<li><p>ro.product.brand、ro.product.model、ro.product.manufacture、ro.product.devicer定义如下：<code class="docutils literal notranslate"><span class="pre">device/mediateksample/k62v1_64_pax/vnd_k62v1_64_pax.mk</span></code></p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>这边只是初步定义，可以全部改变，但是最后是在接下来讲的cpp文件里面改：
MTK_BASE_PROJECT := k62v1_64_pax
PRODUCT_MANUFACTURER := alps
PRODUCT_DEVICE := $(strip $(MTK_BASE_PROJECT))
PRODUCT_MODEL := k62v1_64_pax
PRODUCT_BRAND := alps
</pre></div>
</div>
<section id="id6">
<h4>1.1 ro.product属性初始化赋值<a class="headerlink" href="#id6" title="此标题的永久链接"></a></h4>
<ul class="simple">
<li><p>如下是定制好后的文件<code class="docutils literal notranslate"><span class="pre">system/core/init/property_service.cpp</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>static void property_initialize_ro_product_props() {
    const char* RO_PRODUCT_PROPS_PREFIX = &quot;ro.product.&quot;;
    const char* RO_PRODUCT_PROPS[] = {
			/* [FEATURE]-Modify-BEGIN by (wugangnan@paxsz.com), 2021/05/10, don&#39;t set ro.product property auto*/
            //&quot;brand&quot;, &quot;device&quot;, &quot;manufacturer&quot;, &quot;model&quot;, &quot;name&quot;,  注释掉这里就好了
			&quot;brand&quot;,
			/* [FEATURE]-Modify-END by (wugangnan@paxsz.com), 2021/05/10, don&#39;t set ro.product property auto*/
    };
    const char* RO_PRODUCT_PROPS_ALLOWED_SOURCES[] = {
            &quot;odm&quot;, &quot;product&quot;, &quot;system_ext&quot;, &quot;system&quot;, &quot;vendor&quot;,
    };
    const char* RO_PRODUCT_PROPS_DEFAULT_SOURCE_ORDER = &quot;product,odm,vendor,system_ext,system&quot;;
    const std::string EMPTY = &quot;&quot;;

    std::string ro_product_props_source_order =
            GetProperty(&quot;ro.product.property_source_order&quot;, EMPTY);

    if (!ro_product_props_source_order.empty()) {
        // Verify that all specified sources are valid
        for (const auto&amp; source : Split(ro_product_props_source_order, &quot;,&quot;)) {
            // Verify that the specified source is valid
            bool is_allowed_source = false;
            for (const auto&amp; allowed_source : RO_PRODUCT_PROPS_ALLOWED_SOURCES) {
                if (source == allowed_source) {
                    is_allowed_source = true;
                    break;
                }
            }
            if (!is_allowed_source) {
                LOG(ERROR) &lt;&lt; &quot;Found unexpected source in ro.product.property_source_order; &quot;
                              &quot;using the default property source order&quot;;
                ro_product_props_source_order = RO_PRODUCT_PROPS_DEFAULT_SOURCE_ORDER;
                break;
            }
        }
    } else {
        ro_product_props_source_order = RO_PRODUCT_PROPS_DEFAULT_SOURCE_ORDER;
    }

    for (const auto&amp; ro_product_prop : RO_PRODUCT_PROPS) {
        std::string base_prop(RO_PRODUCT_PROPS_PREFIX);
        base_prop += ro_product_prop;

        std::string base_prop_val = GetProperty(base_prop, EMPTY);
        if (!base_prop_val.empty()) {
            continue;
        }

        for (const auto&amp; source : Split(ro_product_props_source_order, &quot;,&quot;)) {
            std::string target_prop(RO_PRODUCT_PROPS_PREFIX);
            target_prop += source;
            target_prop += &#39;.&#39;;
			
            target_prop += ro_product_prop;

            std::string target_prop_val = GetProperty(target_prop, EMPTY);
            if (!target_prop_val.empty()) {
                LOG(INFO) &lt;&lt; &quot;Setting product property &quot; &lt;&lt; base_prop &lt;&lt; &quot; to &#39;&quot; &lt;&lt; target_prop_val
                          &lt;&lt; &quot;&#39; (from &quot; &lt;&lt; target_prop &lt;&lt; &quot;)&quot;;
                std::string error;
                uint32_t res = PropertySet(base_prop, target_prop_val, &amp;error);//在这里赋值这些变量
                if (res != PROP_SUCCESS) {
                    LOG(ERROR) &lt;&lt; &quot;Error setting product property &quot; &lt;&lt; base_prop &lt;&lt; &quot;: err=&quot; &lt;&lt; res
                               &lt;&lt; &quot; (&quot; &lt;&lt; error &lt;&lt; &quot;)&quot;;
                }
                break;
            }
        }
    }
}
</pre></div>
</div>
<ul class="simple">
<li><p>打印：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Setting</span> <span class="n">product</span> <span class="nb">property</span> <span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">brand</span> <span class="n">to</span> <span class="s1">&#39;PAX&#39;</span> <span class="p">(</span><span class="kn">from</span> <span class="nn">ro.product.odm.brand</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="id7">
<h4>1.2ro.product重新赋值<a class="headerlink" href="#id7" title="此标题的永久链接"></a></h4>
<p>既然在property_initialize_ro_product_props中已经将赋值全部删除，就需要重新赋值，修改如下<code class="docutils literal notranslate"><span class="pre">paxdroid/device/paxdroid_common.mk</span></code>：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>赋值这个属性必须放在root路径下，否则会有selinux权限报错：
ifeq ($(strip $(POS_OS_PLATFORM)), MT6762)
PRODUCT_COPY_FILES += \
        paxdroid/device/build.prop/build_A80.prop:vendor/paxdroid/build_A80.prop \
        paxdroid/device/build.prop/build_IM30.prop:vendor/paxdroid/build_IM30.prop \
        paxdroid/device/etc/pms_app_grant_permission_list.txt:vendor/paxdroid/pms_app_grant_permission_list.txt \
        paxdroid/device/rc_file/M50/init.recovery.M50_V0.rc:root/init.recovery.M50_V0.rc \
        paxdroid/device/rc_file/M50/init.mt6762_M50_V0.rc:root/init.mt6762_M50_V0.rc \
        
init.mt6762_M50_V0.rc: 重新赋值        
on init
	setprop	ro.build.product M50
	
    setprop ro.product.device PAYPHONEM50
	setprop ro.product.model M50
	setprop ro.product.name M50
	setprop	ro.product.board M50
	setprop ro.product.manufacturer PAX
</pre></div>
</div>
</section>
</section>
<section id="ro-product-odm-product-system-vendor-system-ext-device-model-name">
<h3>ro.product.{odm/product/system/vendor/system_ext}.{device/model/name}定义<a class="headerlink" href="#ro-product-odm-product-system-vendor-system-ext-device-model-name" title="此标题的永久链接"></a></h3>
<section id="build-prop">
<h4>1.首先看看build.prop里面的内容<a class="headerlink" href="#build-prop" title="此标题的永久链接"></a></h4>
<ul class="simple">
<li><p>参考M50 Android R代码：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>只展现相关属性
system/build.prop：
ro.product.system.brand=PAX
ro.product.system.device=PAXM50
ro.product.system.manufacturer=PAX
ro.product.system.model=M50
ro.product.system.name=M50
ro.build.product=M50

system/system_ext/build.prop:
ro.product.system_ext.brand=alps
ro.product.system_ext.device=k62v1_64_pax
ro.product.system_ext.manufacturer=alps
ro.product.system_ext.model=k62v1_64_pax
ro.product.system_ext.name=k62v1_64_pax

vendor/build.prop:
ro.product.vendor.brand=alps
ro.product.vendor.device=k62v1_64_pax
ro.product.vendor.manufacturer=alps
ro.product.vendor.model=k62v1_64_pax
ro.product.vendor.name=k62v1_64_pax

vendor/odm/etc/build.prop：
ro.product.odm.brand=alps
ro.product.odm.device=k62v1_64_pax
ro.product.odm.manufacturer=alps
ro.product.odm.model=k62v1_64_pax
ro.product.odm.name=k62v1_64_pax

product/build.prop：
ro.product.product.brand=alps
ro.product.product.device=k62v1_64_pax
ro.product.product.manufacturer=alps
ro.product.product.model=k62v1_64_pax
ro.product.product.name=k62v1_64_pax
</pre></div>
</div>
</section>
<section id="id8">
<h4>2. build.prop生成过程<a class="headerlink" href="#id8" title="此标题的永久链接"></a></h4>
<p>build.prop的生成是由make系统解析build/core/Makefile完成，Makefile生成build.prop的主要代码如下<code class="docutils literal notranslate"><span class="pre">build/make/core/Makefile</span></code>：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>使用的脚本：
BUILDINFO_SH := build/make/tools/buildinfo.sh
BUILDINFO_COMMON_SH := build/make/tools/buildinfo_common.sh
POST_PROCESS_PROPS :=$= build/make/tools/post_process_props.py

ifdef TARGET_SYSTEM_PROP
system_prop_file := $(TARGET_SYSTEM_PROP)
else
system_prop_file := $(wildcard $(TARGET_DEVICE_DIR)/system.prop)
endif
$(intermediate_system_build_prop): $(BUILDINFO_SH) $(BUILDINFO_COMMON_SH) $(INTERNAL_BUILD_ID_MAKEFILE) $(BUILD_SYSTEM)/version_defaults.mk $(system_prop_file) $(INSTALLED_ANDROID_INFO_TXT_TARGET) $(API_FINGERPRINT) $(POST_PROCESS_PROPS)
	@echo Target buildinfo: $@
	@mkdir -p $(dir $@)
	$(hide) echo &gt; $@
ifneq ($(PRODUCT_OEM_PROPERTIES),)
	$(hide) echo &quot;#&quot; &gt;&gt; $@; \
	        echo &quot;# PRODUCT_OEM_PROPERTIES&quot; &gt;&gt; $@; \
	        echo &quot;#&quot; &gt;&gt; $@;
	$(hide) $(foreach prop,$(PRODUCT_OEM_PROPERTIES), \
	    echo &quot;import /oem/oem.prop $(prop)&quot; &gt;&gt; $@;)
endif
	$(hide) PRODUCT_BRAND=&quot;$(PRODUCT_SYSTEM_BRAND)&quot; \
	        PRODUCT_MANUFACTURER=&quot;$(PRODUCT_SYSTEM_MANUFACTURER)&quot; \
	        PRODUCT_MODEL=&quot;$(PRODUCT_SYSTEM_MODEL)&quot; \
	        PRODUCT_NAME=&quot;$(PRODUCT_SYSTEM_NAME)&quot; \
	        PRODUCT_DEVICE=&quot;$(PRODUCT_SYSTEM_DEVICE)&quot; \
	        $(call generate-common-build-props-with-product-vars-set,system,$@)
	$(hide) TARGET_BUILD_TYPE=&quot;$(TARGET_BUILD_VARIANT)&quot; \
	        TARGET_BUILD_FLAVOR=&quot;$(TARGET_BUILD_FLAVOR)&quot; \
	        TARGET_DEVICE=&quot;$(TARGET_DEVICE)&quot; \
	        PRODUCT_DEFAULT_LOCALE=&quot;$(call get-default-product-locale,$(PRODUCT_LOCALES))&quot; \
	        PRODUCT_DEFAULT_WIFI_CHANNELS=&quot;$(PRODUCT_DEFAULT_WIFI_CHANNELS)&quot; \
	        PRIVATE_BUILD_DESC=&quot;$(PRIVATE_BUILD_DESC)&quot; \
	        BUILD_ID=&quot;$(BUILD_ID)&quot; \
	        BUILD_DISPLAY_ID=&quot;$(BUILD_DISPLAY_ID)&quot; \
	        DATE=&quot;$(DATE_FROM_FILE)&quot; \
	        BUILD_USERNAME=&quot;$(BUILD_USERNAME)&quot; \
	        BUILD_HOSTNAME=&quot;$(BUILD_HOSTNAME)&quot; \
	        BUILD_NUMBER=&quot;$(BUILD_NUMBER_FROM_FILE)&quot; \
	        BOARD_BUILD_SYSTEM_ROOT_IMAGE=&quot;$(BOARD_BUILD_SYSTEM_ROOT_IMAGE)&quot; \
	        PLATFORM_VERSION=&quot;$(PLATFORM_VERSION)&quot; \
	        PLATFORM_VERSION_LAST_STABLE=&quot;$(PLATFORM_VERSION_LAST_STABLE)&quot; \
	        PLATFORM_SECURITY_PATCH=&quot;$(PLATFORM_SECURITY_PATCH)&quot; \
	        PLATFORM_BASE_OS=&quot;$(PLATFORM_BASE_OS)&quot; \
	        PLATFORM_SDK_VERSION=&quot;$(PLATFORM_SDK_VERSION)&quot; \
	        PLATFORM_PREVIEW_SDK_VERSION=&quot;$(PLATFORM_PREVIEW_SDK_VERSION)&quot; \
	        PLATFORM_PREVIEW_SDK_FINGERPRINT=&quot;$$(cat $(API_FINGERPRINT))&quot; \
	        PLATFORM_VERSION_CODENAME=&quot;$(PLATFORM_VERSION_CODENAME)&quot; \
	        PLATFORM_VERSION_ALL_CODENAMES=&quot;$(PLATFORM_VERSION_ALL_CODENAMES)&quot; \
	        PLATFORM_MIN_SUPPORTED_TARGET_SDK_VERSION=&quot;$(PLATFORM_MIN_SUPPORTED_TARGET_SDK_VERSION)&quot; \
	        BUILD_VERSION_TAGS=&quot;$(BUILD_VERSION_TAGS)&quot; \
	        $(if $(OEM_THUMBPRINT_PROPERTIES),BUILD_THUMBPRINT=&quot;$(BUILD_THUMBPRINT_FROM_FILE)&quot;) \
	        TARGET_CPU_ABI_LIST=&quot;$(TARGET_CPU_ABI_LIST)&quot; \
	        TARGET_CPU_ABI_LIST_32_BIT=&quot;$(TARGET_CPU_ABI_LIST_32_BIT)&quot; \
	        TARGET_CPU_ABI_LIST_64_BIT=&quot;$(TARGET_CPU_ABI_LIST_64_BIT)&quot; \
	        TARGET_CPU_ABI=&quot;$(TARGET_CPU_ABI)&quot; \
	        TARGET_CPU_ABI2=&quot;$(TARGET_CPU_ABI2)&quot; \
	        bash $(BUILDINFO_SH) &gt;&gt; $@
最后追加余下的属性：
	$(hide) $(foreach file,$(system_prop_file), \
	    if [ -f &quot;$(file)&quot; ]; then \
	        echo Target buildinfo from: &quot;$(file)&quot;; \
	        echo &quot;&quot; &gt;&gt; $@; \
	        echo &quot;#&quot; &gt;&gt; $@; \
	        echo &quot;# from $(file)&quot; &gt;&gt; $@; \
	        echo &quot;#&quot; &gt;&gt; $@; \
	        cat $(file) &gt;&gt; $@; \
	        echo &quot;# end of $(file)&quot; &gt;&gt; $@; \
	    fi;)
	$(if $(FINAL_BUILD_PROPERTIES), \
	    $(hide) echo &gt;&gt; $@; \
	            echo &quot;#&quot; &gt;&gt; $@; \
	            echo &quot;# ADDITIONAL_BUILD_PROPERTIES&quot; &gt;&gt; $@; \
	            echo &quot;#&quot; &gt;&gt; $@; )
	$(hide) $(foreach line,$(FINAL_BUILD_PROPERTIES), \
	    echo &quot;$(line)&quot; &gt;&gt; $@;)
	$(hide) $(POST_PROCESS_PROPS) $@ $(PRODUCT_SYSTEM_PROPERTY_BLACKLIST)

其中system_prop_file定义：
    ifdef TARGET_SYSTEM_PROP
    system_prop_file := $(TARGET_SYSTEM_PROP)
    else
    system_prop_file := $(wildcard $(TARGET_DEVICE_DIR)/system.prop)
    endif
即$(TARGET_DEVICE_DIR)/system.prop文件
这里指的是：device/mediatek/system/common/system.prop
而不是device/mediateksample/k62v1_64_pax/system.prop
　　到此，prop文件生成完毕！
</pre></div>
</div>
<section id="system-build-prop">
<h5>system/build.prop生成过程<a class="headerlink" href="#system-build-prop" title="此标题的永久链接"></a></h5>
<p>以上定义了各种属性需要用到的变量，system/build.prop目前用到两个脚本生成属性<code class="docutils literal notranslate"><span class="pre">buildinfo_common.sh</span></code>及<code class="docutils literal notranslate"><span class="pre">buildinfo.sh</span></code>,以及追加属性system.prop，可以看到如下内容：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">第一部分由buildinfo_common</span><span class="o">.</span><span class="n">sh脚本实现</span>
<span class="c1"># begin common build properties</span>
<span class="c1"># autogenerated by build/make/tools/buildinfo_common.sh</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">date</span><span class="o">=</span><span class="n">Wed</span> <span class="n">Jul</span> <span class="mi">14</span> <span class="mi">04</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">08</span> <span class="n">CST</span> <span class="mi">2021</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">utc</span><span class="o">=</span><span class="mi">1626209888</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">RP1A</span><span class="mf">.200720.011</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">tags</span><span class="o">=</span><span class="n">release</span><span class="o">-</span><span class="n">keys</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">userdebug</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">incremental</span><span class="o">=</span><span class="n">PayDroid1100BirchV15100</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">release</span><span class="o">=</span><span class="mi">11</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">release_or_codename</span><span class="o">=</span><span class="mi">11</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">sdk</span><span class="o">=</span><span class="mi">30</span>
<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">brand</span><span class="o">=</span><span class="n">PAX</span>
<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">manufacturer</span><span class="o">=</span><span class="n">PAX</span>
<span class="c1"># end common build properties   这里截止</span>

<span class="n">第二部分由buildinfo</span><span class="o">.</span><span class="n">sh脚本实现</span>
<span class="c1"># begin build properties</span>
<span class="c1"># autogenerated by buildinfo.sh</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">RP1A</span><span class="mf">.200720.011</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">display</span><span class="o">.</span><span class="n">id</span><span class="o">=</span><span class="n">k62v1_64_pax</span><span class="o">-</span><span class="n">userdebug</span> <span class="mi">11</span> <span class="n">RP1A</span><span class="mf">.200720.011</span> <span class="n">PayDroid1100BirchV15100</span> <span class="n">release</span><span class="o">-</span><span class="n">keys</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">incremental</span><span class="o">=</span><span class="n">PayDroid1100BirchV15100</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">sdk</span><span class="o">=</span><span class="mi">30</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">preview_sdk</span><span class="o">=</span><span class="mi">0</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">preview_sdk_fingerprint</span><span class="o">=</span><span class="n">REL</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">codename</span><span class="o">=</span><span class="n">REL</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">all_codenames</span><span class="o">=</span><span class="n">REL</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">release</span><span class="o">=</span><span class="mi">11</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">release_or_codename</span><span class="o">=</span><span class="mi">11</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">security_patch</span><span class="o">=</span><span class="mi">2021</span><span class="o">-</span><span class="mi">03</span><span class="o">-</span><span class="mi">05</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">base_os</span><span class="o">=</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">version</span><span class="o">.</span><span class="n">min_supported_target_sdk</span><span class="o">=</span><span class="mi">23</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">date</span><span class="o">=</span><span class="n">Wed</span> <span class="n">Jul</span> <span class="mi">14</span> <span class="mi">04</span><span class="p">:</span><span class="mi">58</span><span class="p">:</span><span class="mi">08</span> <span class="n">CST</span> <span class="mi">2021</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">date</span><span class="o">.</span><span class="n">utc</span><span class="o">=</span><span class="mi">1626209888</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">userdebug</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">user</span><span class="o">=</span><span class="n">wugn</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">host</span><span class="o">=</span><span class="n">jcrj</span><span class="o">-</span><span class="n">tf</span><span class="o">-</span><span class="nb">compile</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">tags</span><span class="o">=</span><span class="n">release</span><span class="o">-</span><span class="n">keys</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">system_root_image</span><span class="o">=</span><span class="n">false</span>
<span class="c1"># ro.product.cpu.abi and ro.product.cpu.abi2 are obsolete,</span>
<span class="c1"># use ro.product.cpu.abilist instead.</span>
<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">cpu</span><span class="o">.</span><span class="n">abi</span><span class="o">=</span><span class="n">arm64</span><span class="o">-</span><span class="n">v8a</span>
<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">cpu</span><span class="o">.</span><span class="n">abilist</span><span class="o">=</span><span class="n">arm64</span><span class="o">-</span><span class="n">v8a</span><span class="p">,</span><span class="n">armeabi</span><span class="o">-</span><span class="n">v7a</span><span class="p">,</span><span class="n">armeabi</span>
<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">cpu</span><span class="o">.</span><span class="n">abilist32</span><span class="o">=</span><span class="n">armeabi</span><span class="o">-</span><span class="n">v7a</span><span class="p">,</span><span class="n">armeabi</span>
<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">cpu</span><span class="o">.</span><span class="n">abilist64</span><span class="o">=</span><span class="n">arm64</span><span class="o">-</span><span class="n">v8a</span>
<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">locale</span><span class="o">=</span><span class="n">en</span><span class="o">-</span><span class="n">US</span>
<span class="n">ro</span><span class="o">.</span><span class="n">wifi</span><span class="o">.</span><span class="n">channels</span><span class="o">=</span>
<span class="c1"># Do not try to parse description or thumbprint</span>
<span class="c1"># end build properties</span>


<span class="n">追加属性system</span><span class="o">.</span><span class="n">prop</span>
<span class="c1">#</span>
<span class="c1"># from device/mediatek/system/common/system.prop</span>
<span class="c1">#</span>
<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">property_source_order</span><span class="o">=</span><span class="n">odm</span><span class="p">,</span><span class="n">vendor</span><span class="p">,</span><span class="n">product</span><span class="p">,</span><span class="n">system</span>

<span class="n">vendor</span><span class="o">.</span><span class="n">rild</span><span class="o">.</span><span class="n">libpath</span><span class="o">=</span><span class="n">mtk</span><span class="o">-</span><span class="n">ril</span><span class="o">.</span><span class="n">so</span>
<span class="n">vendor</span><span class="o">.</span><span class="n">rild</span><span class="o">.</span><span class="n">libargs</span><span class="o">=-</span><span class="n">d</span> <span class="o">/</span><span class="n">dev</span><span class="o">/</span><span class="n">ttyC0</span>


<span class="n">wifi</span><span class="o">.</span><span class="n">interface</span><span class="o">=</span><span class="n">wlan0</span>
<span class="n">ro</span><span class="o">.</span><span class="n">mediatek</span><span class="o">.</span><span class="n">wlan</span><span class="o">.</span><span class="n">wsc</span><span class="o">=</span><span class="mi">1</span>
<span class="n">ro</span><span class="o">.</span><span class="n">mediatek</span><span class="o">.</span><span class="n">wlan</span><span class="o">.</span><span class="n">p2p</span><span class="o">=</span><span class="mi">1</span>
<span class="n">mediatek</span><span class="o">.</span><span class="n">wlan</span><span class="o">.</span><span class="n">ctia</span><span class="o">=</span><span class="mi">0</span>


<span class="c1">#</span>
<span class="n">wifi</span><span class="o">.</span><span class="n">tethering</span><span class="o">.</span><span class="n">interface</span><span class="o">=</span><span class="n">ap0</span>
<span class="c1">#</span>

<span class="n">ro</span><span class="o">.</span><span class="n">opengles</span><span class="o">.</span><span class="n">version</span><span class="o">=</span><span class="mi">196610</span>
<span class="c1"># ro.kernel.qemu=1</span>
<span class="c1"># ro.kernel.qemu.gles=0</span>

<span class="n">wifi</span><span class="o">.</span><span class="n">direct</span><span class="o">.</span><span class="n">interface</span><span class="o">=</span><span class="n">p2p0</span>
<span class="c1">#dalvik.vm.heapgrowthlimit=256m</span>
<span class="c1">#dalvik.vm.heapsize=512m</span>

<span class="c1"># USB MTP WHQL</span>
<span class="n">ro</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">usb</span><span class="o">.</span><span class="n">mtp</span><span class="o">.</span><span class="n">whql</span><span class="o">.</span><span class="n">enable</span><span class="o">=</span><span class="mi">0</span>

<span class="c1"># Power off opt in IPO</span>
<span class="n">sys</span><span class="o">.</span><span class="n">ipo</span><span class="o">.</span><span class="n">pwrdncap</span><span class="o">=</span><span class="mi">2</span>

<span class="n">ro</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">usb</span><span class="o">.</span><span class="n">storage</span><span class="o">.</span><span class="n">type</span><span class="o">=</span><span class="n">mtp</span>

<span class="c1"># USB BICR function</span>
<span class="n">ro</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">usb</span><span class="o">.</span><span class="n">bicr</span><span class="o">=</span><span class="n">no</span>

<span class="c1"># USB Charge only function</span>
<span class="n">ro</span><span class="o">.</span><span class="n">sys</span><span class="o">.</span><span class="n">usb</span><span class="o">.</span><span class="n">charging</span><span class="o">.</span><span class="n">only</span><span class="o">=</span><span class="n">yes</span>

<span class="c1"># audio</span>
<span class="n">ro</span><span class="o">.</span><span class="n">camera</span><span class="o">.</span><span class="n">sound</span><span class="o">.</span><span class="n">forced</span><span class="o">=</span><span class="mi">0</span>
<span class="n">ro</span><span class="o">.</span><span class="n">audio</span><span class="o">.</span><span class="n">silent</span><span class="o">=</span><span class="mi">0</span>

<span class="n">ro</span><span class="o">.</span><span class="n">zygote</span><span class="o">.</span><span class="n">preload</span><span class="o">.</span><span class="n">enable</span><span class="o">=</span><span class="mi">0</span>

<span class="c1"># temporary enables NAV bar (soft keys)</span>
<span class="n">qemu</span><span class="o">.</span><span class="n">hw</span><span class="o">.</span><span class="n">mainkeys</span><span class="o">=</span><span class="mi">0</span>

<span class="n">ro</span><span class="o">.</span><span class="n">kernel</span><span class="o">.</span><span class="n">zio</span><span class="o">=</span><span class="mi">38</span><span class="p">,</span><span class="mi">108</span><span class="p">,</span><span class="mi">105</span><span class="p">,</span><span class="mi">16</span>
<span class="c1">#ro.kernel.qemu=1</span>
<span class="c1">#ro.kernel.qemu.gles=0</span>
<span class="c1">#ro.boot.selinux=disable</span>

<span class="c1"># Disable dirty region for Mali</span>
<span class="c1">#debug.hwui.render_dirty_regions=false</span>


<span class="c1"># performance</span>
<span class="n">ro</span><span class="o">.</span><span class="n">mtk_perf_simple_start_win</span><span class="o">=</span><span class="mi">1</span>
<span class="n">ro</span><span class="o">.</span><span class="n">mtk_perf_fast_start_win</span><span class="o">=</span><span class="mi">1</span>
<span class="n">ro</span><span class="o">.</span><span class="n">mtk_perf_response_time</span><span class="o">=</span><span class="mi">1</span>

<span class="c1"># disable ipo for development</span>
<span class="n">sys</span><span class="o">.</span><span class="n">ipo</span><span class="o">.</span><span class="n">disable</span><span class="o">=</span><span class="mi">1</span>

<span class="c1"># identity</span>
<span class="n">Build</span><span class="o">.</span><span class="n">BRAND</span><span class="o">=</span><span class="n">MTK</span>

<span class="c1"># Disable iorapd</span>
<span class="n">ro</span><span class="o">.</span><span class="n">iorapd</span><span class="o">.</span><span class="n">enable</span><span class="o">=</span><span class="n">false</span>

<span class="c1"># end of device/mediatek/system/common/system.prop</span>

<span class="c1">#</span>
<span class="c1"># from paxdroid/device/build.prop/build_k62v1_64_pax.prop</span>
<span class="c1">#</span>
<span class="n">ro</span><span class="o">.</span><span class="n">config</span><span class="o">.</span><span class="n">vc_call_vol_default</span><span class="o">=</span><span class="mi">5</span>
<span class="c1"># end of paxdroid/device/build.prop/build_k62v1_64_pax.prop</span>

<span class="c1">#</span>
<span class="c1"># ADDITIONAL_BUILD_PROPERTIES</span>
<span class="c1">#</span>
<span class="n">ro</span><span class="o">.</span><span class="n">treble</span><span class="o">.</span><span class="n">enabled</span><span class="o">=</span><span class="n">true</span>
<span class="n">persist</span><span class="o">.</span><span class="n">debug</span><span class="o">.</span><span class="n">dalvik</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">core_platform_api_policy</span><span class="o">=</span><span class="n">just</span><span class="o">-</span><span class="n">warn</span>
<span class="n">dalvik</span><span class="o">.</span><span class="n">vm</span><span class="o">.</span><span class="n">lockprof</span><span class="o">.</span><span class="n">threshold</span><span class="o">=</span><span class="mi">500</span>
<span class="n">net</span><span class="o">.</span><span class="n">bt</span><span class="o">.</span><span class="n">name</span><span class="o">=</span><span class="n">Android</span>
</pre></div>
</div>
</section>
</section>
<section id="vendor-build-prop">
<h4>3.vendor/build.prop生成过程<a class="headerlink" href="#vendor-build-prop" title="此标题的永久链接"></a></h4>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">build/make/core/Makefile</span></code>这里是和system中的差不多:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span># -----------------------------------------------------------------
# vendor build.prop
#
# For verifying that the vendor build is what we think it is
INSTALLED_VENDOR_BUILD_PROP_TARGET := $(TARGET_OUT_VENDOR)/build.prop
ALL_DEFAULT_INSTALLED_MODULES += $(INSTALLED_VENDOR_BUILD_PROP_TARGET)

ifdef TARGET_VENDOR_PROP
vendor_prop_files := $(TARGET_VENDOR_PROP)
else
vendor_prop_files := $(wildcard $(TARGET_DEVICE_DIR)/vendor.prop)
endif

ifdef property_overrides_split_enabled
FINAL_VENDOR_BUILD_PROPERTIES += \
    $(call collapse-pairs, $(PRODUCT_PROPERTY_OVERRIDES))
FINAL_VENDOR_BUILD_PROPERTIES := $(call uniq-pairs-by-first-component, \
    $(FINAL_VENDOR_BUILD_PROPERTIES),=)
endif  # property_overrides_split_enabled

1.开始一段的属性在这里写的：
$(INSTALLED_VENDOR_BUILD_PROP_TARGET): $(BUILDINFO_COMMON_SH) $(POST_PROCESS_PROPS) $(intermediate_system_build_prop) $(vendor_prop_files)
	@echo Target vendor buildinfo: $@
	@mkdir -p $(dir $@)
	$(hide) echo &gt; $@
ifeq ($(PRODUCT_USE_DYNAMIC_PARTITIONS),true)
	$(hide) echo ro.boot.dynamic_partitions=true &gt;&gt; $@
endif
ifeq ($(PRODUCT_RETROFIT_DYNAMIC_PARTITIONS),true)
	$(hide) echo ro.boot.dynamic_partitions_retrofit=true &gt;&gt; $@
endif
	$(hide) grep &#39;ro.product.first_api_level&#39; $(intermediate_system_build_prop) &gt;&gt; $@ || true
	$(hide) echo ro.vendor.build.security_patch=&quot;$(VENDOR_SECURITY_PATCH)&quot;&gt;&gt;$@
	$(hide) echo ro.vendor.product.cpu.abilist=&quot;$(TARGET_CPU_ABI_LIST)&quot;&gt;&gt;$@
	$(hide) echo ro.vendor.product.cpu.abilist32=&quot;$(TARGET_CPU_ABI_LIST_32_BIT)&quot;&gt;&gt;$@
	$(hide) echo ro.vendor.product.cpu.abilist64=&quot;$(TARGET_CPU_ABI_LIST_64_BIT)&quot;&gt;&gt;$@
	#[FEATURE]-Add-BEGIN by (wugangnan@paxsz.com), 2021/05/11, delete prop ro.product.board set in vendor&#39;s prop file
	#$(hide) echo ro.product.board=&quot;$(TARGET_BOOTLOADER_BOARD_NAME)&quot;&gt;&gt;$@
	#[FEATURE]-Add-END by (wugangnan@paxsz.com), 2021/05/11, delete prop ro.product.board set in vendor&#39;s prop file
	$(hide) echo ro.board.platform=&quot;$(TARGET_BOARD_PLATFORM)&quot;&gt;&gt;$@
	$(hide) echo ro.hwui.use_vulkan=&quot;$(TARGET_USES_VULKAN)&quot;&gt;&gt;$@
ifdef TARGET_SCREEN_DENSITY
	$(hide) echo ro.sf.lcd_density=&quot;$(TARGET_SCREEN_DENSITY)&quot;&gt;&gt;$@
endif
ifeq ($(AB_OTA_UPDATER),true)
	$(hide) echo ro.build.ab_update=true &gt;&gt; $@
endif


2.调用buildinfo_common.sh写vendor分区专有属性，ro.vendor.build类
	$(hide) $(call generate-common-build-props,vendor,$@)
	$(hide) echo &quot;#&quot; &gt;&gt; $@; \
	        echo &quot;# BOOTIMAGE_BUILD_PROPERTIES&quot; &gt;&gt; $@; \
	        echo &quot;#&quot; &gt;&gt; $@;
	$(hide) echo ro.bootimage.build.date=`$(DATE_FROM_FILE)`&gt;&gt;$@
	$(hide) echo ro.bootimage.build.date.utc=`$(DATE_FROM_FILE) +%s`&gt;&gt;$@
	#[FEATURE]-Add-BEGIN by (wugangnan@paxsz.com), 2021/05/11, delete prop ro.bootimage.build.fingerprint set in vendor&#39;s prop file
	#$(hide) echo ro.bootimage.build.fingerprint=&quot;$(BUILD_FINGERPRINT_FROM_FILE)&quot;&gt;&gt;$@
	#[FEATURE]-Add-END by (wugangnan@paxsz.com), 2021/05/11, delete prop ro.bootimage.build.fingerprint set in vendor&#39;s prop file
	
3.最后追加余下的属性：

	$(hide) echo &quot;#&quot; &gt;&gt; $@; \
	        echo &quot;# ADDITIONAL VENDOR BUILD PROPERTIES&quot; &gt;&gt; $@; \
	        echo &quot;#&quot; &gt;&gt; $@;
	$(hide) cat $(INSTALLED_ANDROID_INFO_TXT_TARGET) | grep &#39;require version-&#39; | sed -e &#39;s/require version-/ro.build.expect./g&#39; &gt;&gt; $@
ifdef property_overrides_split_enabled
	$(hide) $(foreach file,$(vendor_prop_files), \
	    if [ -f &quot;$(file)&quot; ]; then \
	        echo Target vendor properties from: &quot;$(file)&quot;; \
	        echo &quot;&quot; &gt;&gt; $@; \
	        echo &quot;#&quot; &gt;&gt; $@; \
	        echo &quot;# from $(file)&quot; &gt;&gt; $@; \
	        echo &quot;#&quot; &gt;&gt; $@; \
	        cat $(file) &gt;&gt; $@; \
	        echo &quot;# end of $(file)&quot; &gt;&gt; $@; \
	    fi;)
	$(hide) $(foreach line,$(FINAL_VENDOR_BUILD_PROPERTIES), \
	    echo &quot;$(line)&quot; &gt;&gt; $@;)
endif  # property_overrides_split_enabled
	$(hide) $(POST_PROCESS_PROPS) $@ $(PRODUCT_VENDOR_PROPERTY_BLACKLIST)

# -----------------------------------------------------------------
# product build.prop

其中vendor_prop_files定义如下：
ifdef TARGET_VENDOR_PROP
vendor_prop_files := $(TARGET_VENDOR_PROP)
else
vendor_prop_files := $(wildcard $(TARGET_DEVICE_DIR)/vendor.prop)
endif
但是device/mediatek/system/common/目录下面没有vendor.prop文件

继续追踪FINAL_VENDOR_BUILD_PROPERTIES
ifdef property_overrides_split_enabled
FINAL_VENDOR_BUILD_PROPERTIES += \
    $(call collapse-pairs, $(PRODUCT_PROPERTY_OVERRIDES))
FINAL_VENDOR_BUILD_PROPERTIES := $(call uniq-pairs-by-first-component, \
    $(FINAL_VENDOR_BUILD_PROPERTIES),=)
endif  # property_overrides_split_enabled

而PRODUCT_PROPERTY_OVERRIDES则在device/mediatek/common/device.mk被赋值，如：
ifeq ($(strip $(MTK_EXTERNAL_SIM_RSIM_ENHANCEMENT)), yes)
  PRODUCT_PROPERTY_OVERRIDES += ro.vendor.mtk_non_dsda_rsim_support=1
endif
所以这里才是真正的追加属性。


以上函数generate-common-build-props定义，主要是给要用到的变量赋值，给sh脚本用：

# Generates a set of sysprops common to all partitions to a file.
# $(1): Partition name
# $(2): Output file name
define generate-common-build-props
	PRODUCT_BRAND=&quot;$(PRODUCT_BRAND)&quot; \
	PRODUCT_DEVICE=&quot;$(TARGET_DEVICE)&quot; \
	PRODUCT_MANUFACTURER=&quot;$(PRODUCT_MANUFACTURER)&quot; \
	PRODUCT_MODEL=&quot;$(PRODUCT_MODEL)&quot; \
	PRODUCT_NAME=&quot;$(TARGET_PRODUCT)&quot; \
	$(call generate-common-build-props-with-product-vars-set,$(1),$(2))
endef

# Like the above macro, but requiring the relevant PRODUCT_ environment
# variables to be set when called.
define generate-common-build-props-with-product-vars-set
	BUILD_FINGERPRINT=&quot;$(BUILD_FINGERPRINT_FROM_FILE)&quot; \
	BUILD_ID=&quot;$(BUILD_ID)&quot; \
	BUILD_NUMBER=&quot;$(BUILD_NUMBER_FROM_FILE)&quot; \
	BUILD_VERSION_TAGS=&quot;$(BUILD_VERSION_TAGS)&quot; \
	DATE=&quot;$(DATE_FROM_FILE)&quot; \
	PLATFORM_SDK_VERSION=&quot;$(PLATFORM_SDK_VERSION)&quot; \
	PLATFORM_VERSION_LAST_STABLE=&quot;$(PLATFORM_VERSION_LAST_STABLE)&quot; \
	PLATFORM_VERSION=&quot;$(PLATFORM_VERSION)&quot; \
	TARGET_BUILD_TYPE=&quot;$(TARGET_BUILD_VARIANT)&quot; \
	bash $(BUILDINFO_COMMON_SH) &quot;$(1)&quot; &gt;&gt; $(2)
endef
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">build/make/tools/buildinfo_common.sh</span></code>这个脚本的意思是传参partition信息，比如vendor分区传进来，会执行<code class="docutils literal notranslate"><span class="pre">echo</span> <span class="pre">&quot;ro.vendor.build.id=$BUILD_ID&quot;</span></code>内容如下:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="ch">#!/bin/bash</span>

<span class="n">partition</span><span class="o">=</span><span class="s2">&quot;$1&quot;</span>

<span class="k">if</span> <span class="p">[</span> <span class="s2">&quot;$#&quot;</span> <span class="o">-</span><span class="n">ne</span> <span class="mi">1</span> <span class="p">];</span> <span class="n">then</span>
  <span class="n">echo</span> <span class="s2">&quot;Usage: $0 &lt;partition&gt;&quot;</span> <span class="mi">1</span><span class="o">&gt;&amp;</span><span class="mi">2</span>
  <span class="n">exit</span> <span class="mi">1</span>
<span class="n">fi</span>

<span class="n">echo</span> <span class="s2">&quot;# begin common build properties&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;# autogenerated by $0&quot;</span>

<span class="n">echo</span> <span class="s2">&quot;ro.$</span><span class="si">{partition}</span><span class="s2">.build.date=`$DATE`&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;ro.$</span><span class="si">{partition}</span><span class="s2">.build.date.utc=`$DATE +</span><span class="si">%s</span><span class="s2">`&quot;</span>
<span class="c1">#[FEATURE]-Add-BEGIN by (wugangnan@paxsz.com), 2021/05/11, delete ro.${partition}.build.fingerprint set</span>
<span class="c1">#echo &quot;ro.${partition}.build.fingerprint=$BUILD_FINGERPRINT&quot;</span>
<span class="c1">#[FEATURE]-Add-END by (wugangnan@paxsz.com), 2021/05/11, delete ro.${partition}.build.fingerprint set </span>
<span class="n">echo</span> <span class="s2">&quot;ro.$</span><span class="si">{partition}</span><span class="s2">.build.id=$BUILD_ID&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;ro.$</span><span class="si">{partition}</span><span class="s2">.build.tags=$BUILD_VERSION_TAGS&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;ro.$</span><span class="si">{partition}</span><span class="s2">.build.type=$TARGET_BUILD_TYPE&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;ro.$</span><span class="si">{partition}</span><span class="s2">.build.version.incremental=$BUILD_NUMBER&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;ro.$</span><span class="si">{partition}</span><span class="s2">.build.version.release=$PLATFORM_VERSION_LAST_STABLE&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;ro.$</span><span class="si">{partition}</span><span class="s2">.build.version.release_or_codename=$PLATFORM_VERSION&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;ro.$</span><span class="si">{partition}</span><span class="s2">.build.version.sdk=$PLATFORM_SDK_VERSION&quot;</span>

<span class="n">echo</span> <span class="s2">&quot;ro.product.$</span><span class="si">{partition}</span><span class="s2">.brand=$PRODUCT_BRAND&quot;</span>
<span class="c1">#[FEATURE]-Add-BEGIN by (wugangnan@paxsz.com), 2021/05/11, delete prop ro.product.product set </span>
<span class="c1">#echo &quot;ro.product.${partition}.device=$PRODUCT_DEVICE&quot;</span>
<span class="n">echo</span> <span class="s2">&quot;ro.product.$</span><span class="si">{partition}</span><span class="s2">.manufacturer=$PRODUCT_MANUFACTURER&quot;</span>
<span class="c1">#echo &quot;ro.product.${partition}.model=$PRODUCT_MODEL&quot;</span>
<span class="c1">#echo &quot;ro.product.${partition}.name=$PRODUCT_NAME&quot;</span>
<span class="c1">#[FEATURE]-Add-END by (wugangnan@paxsz.com), 2021/05/11, delete prop ro.product.product set</span>

<span class="n">echo</span> <span class="s2">&quot;# end common build properties&quot;</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vendor/build.prop</span></code>n内容如下:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>1.开始的属性是Makefile中去写的：
ro.boot.dynamic_partitions=true
ro.product.first_api_level=30
ro.vendor.build.security_patch=2021-03-05
ro.vendor.product.cpu.abilist=arm64-v8a,armeabi-v7a,armeabi
ro.vendor.product.cpu.abilist32=armeabi-v7a,armeabi
ro.vendor.product.cpu.abilist64=arm64-v8a
ro.board.platform=mt6765
ro.hwui.use_vulkan=
ro.build.ab_update=true

2.buildinfo_common.sh写的属性
# begin common build properties
# autogenerated by build/make/tools/buildinfo_common.sh
ro.vendor.build.date=Thu Jul 15 03:04:24 CST 2021
ro.vendor.build.date.utc=1626289464
ro.vendor.build.id=RP1A.200720.011
ro.vendor.build.tags=release-keys
ro.vendor.build.type=userdebug
ro.vendor.build.version.incremental=PayDroid1100BirchV15100
ro.vendor.build.version.release=11
ro.vendor.build.version.release_or_codename=11
ro.vendor.build.version.sdk=30
ro.product.vendor.brand=PAX
ro.product.vendor.manufacturer=PAX
# end common build properties
这里结束

#
# BOOTIMAGE_BUILD_PROPERTIES
#
ro.bootimage.build.date=Thu Jul 15 03:04:24 CST 2021
ro.bootimage.build.date.utc=1626289464
#
# ADDITIONAL VENDOR BUILD PROPERTIES
#
ro.virtual_ab.enabled=true
debug.mtk_tflite.target_nnapi=29
ro.vendor.mtk_nn.option=A,B,C,D,E,F,G,Z
ro.vendor.mtk_nn_quant_preferred=1
init.userspace_reboot.is_supported=true
ro.carrier=unknown
ro.config.notification_sound=OnTheHunt.ogg
ro.config.alarm_alert=Alarm_Classic.ogg
ro.hardware.egl=meow
ro.vendor.enable.geo.fencing=1
vendor.camera.mdp.cz.enable=1
ro.opengles.version=196610
persist.vendor.radio.fd.counter=150
persist.vendor.radio.fd.off.counter=50
persist.vendor.radio.fd.r8.counter=150
persist.vendor.radio.fd.off.r8.counter=50
dalvik.vm.mtk-stack-trace-file=/data/anr/mtk_traces.txt
ro.frp.pst=/dev/block/platform/bootdevice/by-name/frp
ro.vendor.camera3.zsl.default=130
ro.vendor.mediatek.platform=MT6765
ro.surface_flinger.vsync_event_phase_offset_ns=
ro.surface_flinger.vsync_sf_event_phase_offset_ns=
ro.lmk.psi_complete_stall_ms=70
ro.lmk.swap_free_low_percentage=20
ro.vendor.mtk_config_max_dram_size=0x800000000
dalvik.vm.heapgrowthlimit=256m
dalvik.vm.heapsize=512m
ro.vendor.mtk_f2fs_enable=0
ro.vendor.mtk_protocol1_rat_config=Lf/Lt/W/G
ro.telephony.default_network=9,9,9,9
ro.vendor.mtk_md1_support=9
ro.vendor.mtk_c2k_lte_mode=0
ro.vendor.mtk_eccci_c2k=1
ro.vendor.mtk_ps1_rat=Lf/Lt/W/G
ro.vendor.mtk_lte_support=1
ro.vendor.mtk_audio_alac_support=1
ro.vendor.num_md_protocol=2
ro.vendor.mtk_privacy_protection_lock=1
vendor.camera.mdp.dre.enable=0
persist.vendor.camera3.pipeline.bufnum.min.high_ram.imgo=7
persist.vendor.camera3.pipeline.bufnum.min.low_ram.imgo=6
persist.vendor.camera3.pipeline.bufnum.base.imgo=4
persist.vendor.camera3.pipeline.bufnum.min.high_ram.rrzo=7
persist.vendor.camera3.pipeline.bufnum.min.low_ram.rrzo=6
persist.vendor.camera3.pipeline.bufnum.base.rrzo=4
persist.vendor.camera3.pipeline.bufnum.min.high_ram.lcso=7
persist.vendor.camera3.pipeline.bufnum.min.low_ram.lcso=6
persist.vendor.camera3.pipeline.bufnum.base.lcso=4
persist.vendor.camera3.pipeline.bufnum.min.high_ram.rsso=7
persist.vendor.camera3.pipeline.bufnum.min.low_ram.rsso=6
persist.vendor.camera3.pipeline.bufnum.base.rsso=5
persist.vendor.camera3.pipeline.bufnum.min.high_ram.fdyuv=5
persist.vendor.camera3.pipeline.bufnum.min.low_ram.fdyuv=5
ro.vendor.mediatek.version.branch=alps-mp-r0.mp1
ro.vendor.mediatek.version.release=PayDroid_11.0.0_Birch_V15.2.00_20210715
persist.radio.multisim.config=dsds
persist.vendor.radio.msimmode=dsds
ro.vendor.radio.max.multisim=dsds
ro.telephony.sim.count=2
telephony.active_modems.max_count=2
ro.vendor.mtk_besloudness_support=1
ro.vendor.mtk_wapi_support=1
ro.vendor.mtk_wappush_support=1
ro.vendor.mtk_agps_app=1
ro.vendor.mtk_audio_tuning_tool_ver=V2.2
ro.vendor.wifi.sap.interface=ap0
wifi.concurrent.interface=ap0
ro.vendor.mtk_gps_support=1
ro.vendor.mtk_fd_support=1
drm.service.enabled=true
ro.vendor.mtk_widevine_drm_l3_support=1
ro.vendor.mtk_audio_ape_support=1
ro.vendor.mtk_emmc_support=1
ro.vendor.mtk_ril_mode=c6m_1rild
ro.vendor.md_prop_ver=1
ro.vendor.mtk_aal_support=1
ro.vendor.mtk_pq_support=2
ro.vendor.mtk_pq_color_mode=1
ro.vendor.mtk_blulight_def_support=1
ro.vendor.mtk_wfd_support=1
ro.vendor.mtk_world_phone_policy=0
ro.vendor.mtk_md_world_mode_support=1
ro.vendor.mtk_sim_hot_swap_common_slot=1
ro.vendor.mtk_sim_card_onoff=3
ro.vendor.mtk_mobile_management=1
ro.vendor.mtk_zsdhdr_support=1
ro.vendor.mtk_slow_motion_support=1
ro.vendor.mtk_rild_read_imsi=1
ro.vendor.sim_refresh_reset_by_modem=1
ro.vendor.mtk_external_sim_support=1
ro.vendor.mtk_external_sim_only_slots=0
ro.vendor.sim_me_lock_mode=0
ro.vendor.ap_info_monitor=0
ro.vendor.md_auto_setup_ims=1
persist.vendor.ims_support=1
persist.vendor.mtk_dynamic_ims_switch=1
persist.vendor.mims_support=2
persist.vendor.mtk_wfc_support=1
persist.vendor.volte_support=1
persist.vendor.mtk.volte.enable=1
persist.vendor.vilte_support=1
persist.vendor.viwifi_support=1
ro.vendor.wfd.dummy.enable=0
ro.vendor.wfd.iframesize.level=0
ro.vendor.mtk_trustkernel_tee_support=1
ro.hardware.kmsetkey=trustkernel
ro.hardware.gatekeeper=trustkernel
persist.vendor.connsys.coredump.mode=2
persist.vendor.connsys.chipid=-1
persist.vendor.connsys.patch.version=-1
persist.vendor.connsys.dynamic.dump=0
vendor.connsys.driver.ready=no
persist.vendor.connsys.fm_chipid=mt6631
ro.vendor.wlan.gen=gen4m
persist.vendor.radio.mtk_dsbp_support=1
persist.vendor.mtk_ct_volte_support=1
persist.vendor.radio.mtk_ps2_rat=L/W/G
persist.vendor.radio.mtk_ps3_rat=G
persist.log.tag.RILMUXD=I
persist.vendor.log.tel_log_ctrl=1
persist.log.tag.AT=I
persist.log.tag.RILC-MTK=I
persist.log.tag.RILC=I
persist.log.tag.RfxMainThread=I
persist.log.tag.RfxRoot=I
persist.log.tag.RfxRilAdapter=I
persist.log.tag.RfxController=I
persist.log.tag.RILC-RP=I
persist.log.tag.RfxTransUtils=I
persist.log.tag.RfxMclDisThread=I
persist.log.tag.RfxCloneMgr=I
persist.log.tag.RfxHandlerMgr=I
persist.log.tag.RfxIdToStr=I
persist.log.tag.RfxDisThread=I
persist.log.tag.RfxMclStatusMgr=I
persist.log.tag.RIL-Fusion=I
persist.log.tag.RtcEccNumberController=D
persist.log.tag.RmcEccNumberUrcHandler=D
persist.log.tag.RpPhoneNumberController=D
persist.log.tag.RilOpProxy=I
persist.log.tag.RILC-OP=I
persist.log.tag.RilOemClient=I
persist.log.tag.WpfaCcciDataHeaderEncoder=I
persist.log.tag.WpfaCcciReader=I
persist.log.tag.WpfaCcciSender=I
persist.log.tag.WpfaControlMsgHandler=I
persist.log.tag.WpfaDriver=I
persist.log.tag.WpfaDriverAccept=I
persist.log.tag.WpfaDriverAdapter=I
persist.log.tag.WpfaDriverDeReg=I
persist.log.tag.WpfaDriverMessage=I
persist.log.tag.WpfaDriverRegFilter=I
persist.log.tag.WpfaDriverULIpPkt=I
persist.log.tag.WpfaDriverUtilis=I
persist.log.tag.WpfaDriverVersion=I
persist.log.tag.WpfaFilterRuleReqHandler=I
persist.log.tag.WpfaRingBuffer=I
persist.log.tag.WpfaShmAccessController=I
persist.log.tag.WpfaShmReadMsgHandler=I
persist.log.tag.WpfaShmSynchronizer=I
persist.log.tag.WpfaShmWriteMsgHandler=I
persist.log.tag.wpfa_iptable_android=I
persist.log.tag.WpfaRuleRegister=I
persist.log.tag.WpfaParsing=I
persist.log.tag.WpfaRuleContainer=I
persist.log.tag.MtkDct=I
persist.log.tag.MtkDc=I
persist.log.tag.MtkDcc=I
persist.log.tag.MtkRetryManager=I
persist.log.tag.DcFcMgr=I
persist.log.tag.RtcDC=I
persist.log.tag.RmcDcCommon=I
persist.log.tag.NetAgentService=I
persist.log.tag.NetAgent_IO=I
persist.log.tag.NetLnkEventHdlr=I
persist.log.tag.RIL-DATA=I
persist.log.tag.C2K_RIL-DATA=I
persist.log.tag.GsmCdmaPhone=I
persist.log.tag.RILMD2-SS=I
persist.log.tag.CapaSwitch=I
persist.log.tag.DSSelector=I
persist.log.tag.DSSelectorOm=I
persist.log.tag.DSSelectorOP01=I
persist.log.tag.DSSelectorOP02=I
persist.log.tag.DSSelectorOP09=I
persist.log.tag.DSSelectorOP18=I
persist.log.tag.DSSelectorUtil=I
persist.log.tag.SimSwitchOP01=I
persist.log.tag.SimSwitchOP02=I
persist.log.tag.SimSwitchOP18=I
persist.log.tag.IccProvider=I
persist.log.tag.IccPhoneBookIM=I
persist.log.tag.AdnRecordCache=I
persist.log.tag.AdnRecordLoader=I
persist.log.tag.AdnRecord=I
persist.log.tag.RIL-PHB=I
persist.log.tag.MtkIccProvider=I
persist.log.tag.MtkIccPHBIM=I
persist.log.tag.MtkAdnRecord=I
persist.log.tag.MtkRecordLoader=I
persist.log.tag.RpPhbController=I
persist.log.tag.RmcPhbReq=I
persist.log.tag.RmcPhbUrc=I
persist.log.tag.RtcPhb=I
persist.log.tag.VT=I
persist.log.tag.ImsVTProvider=I
persist.log.tag.IccCardProxy=I
persist.log.tag.IsimFileHandler=I
persist.log.tag.IsimRecords=I
persist.log.tag.SIMRecords=I
persist.log.tag.SpnOverride=I
persist.log.tag.UiccCard=I
persist.log.tag.UiccController=I
persist.log.tag.RIL-SIM=I
persist.log.tag.CountryDetector=I
persist.log.tag.NetworkStats=I
persist.log.tag.NetworkPolicy=I
persist.log.tag.DataDispatcher=I
persist.log.tag.ImsService=I
persist.log.tag.IMS_RILA=I
persist.log.tag.IMSRILRequest=I
persist.log.tag.ImsManager=I
persist.log.tag.ImsApp=I
persist.log.tag.ImsBaseCommands=I
persist.log.tag.MtkImsManager=I
persist.log.tag.MtkImsService=I
persist.log.tag.RP_IMS=I
persist.log.tag.RtcIms=I
persist.log.tag.RtcImsConference=I
persist.log.tag.RtcImsDialog=I
persist.log.tag.RmcImsCtlUrcHdl=I
persist.log.tag.RmcImsCtlReqHdl=I
persist.log.tag.ImsCall=I
persist.log.tag.ImsPhone=I
persist.log.tag.ImsPhoneCall=I
persist.log.tag.ImsPhoneBase=I
persist.log.tag.ImsCallSession=I
persist.log.tag.ImsCallProfile=I
persist.log.tag.ImsEcbm=I
persist.log.tag.ImsEcbmProxy=I
persist.log.tag.OperatorUtils=I
persist.log.tag.WfoApp=I
persist.log.tag.GsmCdmaConn=I
persist.log.tag.Phone=I
persist.log.tag.RIL-CC=I
persist.log.tag.RpCallControl=I
persist.log.tag.RpAudioControl=I
persist.log.tag.GsmCallTkrHlpr=I
persist.log.tag.MtkPhoneNotifr=I
persist.log.tag.MtkFactory=I
persist.log.tag.MtkGsmCdmaConn=I
persist.log.tag.RadioManager=I
persist.log.tag.RIL_Mux=I
persist.log.tag.RIL-OEM=I
persist.log.tag.RIL=I
persist.log.tag.RIL_UIM_SOCKET=I
persist.log.tag.RILD=I
persist.log.tag.RIL-RP=I
persist.log.tag.RfxMessage=I
persist.log.tag.RfxDebugInfo=I
persist.log.tag.RfxTimer=I
persist.log.tag.RfxObject=I
persist.log.tag.SlotQueueEntry=I
persist.log.tag.RfxAction=I
persist.log.tag.RFX=I
persist.log.tag.RpRadioMessage=I
persist.log.tag.RpModemMessage=I
persist.log.tag.PhoneFactory=I
persist.log.tag.ProxyController=I
persist.log.tag.AirplaneHandler=I
persist.log.tag.RfxDefDestUtils=I
persist.log.tag.RfxSM=I
persist.log.tag.RfxSocketSM=I
persist.log.tag.RfxDT=I
persist.log.tag.RpCdmaOemCtrl=I
persist.log.tag.RpRadioCtrl=I
persist.log.tag.RpMDCtrl=I
persist.log.tag.RpCdmaRadioCtrl=I
persist.log.tag.RpFOUtils=I
persist.log.tag.ExternalSimMgr=I
persist.log.tag.VsimAdaptor=I
persist.log.tag.MtkCsimFH=I
persist.log.tag.MtkIsimFH=I
persist.log.tag.MtkRuimFH=I
persist.log.tag.MtkSIMFH=I
persist.log.tag.MtkSIMRecords=I
persist.log.tag.MtkSmsCbHeader=I
persist.log.tag.MtkSmsManager=I
persist.log.tag.MtkSmsMessage=I
persist.log.tag.MtkSpnOverride=I
persist.log.tag.MtkIccCardProxy=I
persist.log.tag.MtkUiccCard=I
persist.log.tag.MtkUiccCardApp=I
persist.log.tag.MtkUiccCtrl=I
persist.log.tag.MtkUsimFH=I
persist.log.tag.RpRilClientCtrl=I
persist.log.tag.RilMalClient=I
persist.log.tag.RpSimController=I
persist.log.tag.MtkSubCtrl=I
persist.log.tag.RmcEmbmsReq=I
persist.log.tag.RmcEmbmsUrc=I
persist.log.tag.RtcEmbmsUtil=I
persist.log.tag.RtcEmbmsAt=I
persist.log.tag.MtkEmbmsAdaptor=I
persist.log.tag.RP_DAC=I
persist.log.tag.RP_DC=I
persist.log.tag.RTC_DAC=I
persist.log.tag.RilClient=I
persist.log.tag.RmcCommSimReq=I
persist.log.tag.RmcCdmaSimRequest=I
persist.log.tag.RmcGsmSimRequest=I
persist.log.tag.RmcCommSimUrc=I
persist.log.tag.RmcGsmSimUrc=I
persist.log.tag.RtcCommSimCtrl=I
persist.log.tag.RmcCommSimOpReq=I
persist.log.tag.RtcRadioCont=I
persist.log.tag.RmcDcPdnManager=I
persist.log.tag.RmcDcReqHandler=I
persist.log.tag.RmcDcUtility=I
persist.log.tag.RfxIdToMsgId=I
persist.log.tag.RfxOpUtils=I
persist.log.tag.RfxMclMessenger=I
persist.log.tag.RfxFragEnc=I
persist.log.tag.RfxStatusMgr=I
persist.log.tag.MTKSST=D
persist.log.tag.RfxRilUtils=I
persist.log.tag.RmcNwHdlr=D
persist.log.tag.RmcNwReqHdlr=D
persist.log.tag.RmcNwRTReqHdlr=D
persist.log.tag.RmcRatSwHdlr=D
persist.log.tag.RtcRatSwCtrl=D
persist.log.tag.RtcNwCtrl=I
persist.log.tag.RmcRadioReq=I
persist.log.tag.RmcCapa=I
persist.log.tag.RtcCapa=I
persist.log.tag.RpMalController=I
persist.log.tag.WORLDMODE=I
persist.log.tag.RtcWp=I
persist.log.tag.RmcWp=I
persist.log.tag.RmcOpRadioReq=I
persist.log.tag.RfxContFactory=I
persist.log.tag.RfxChannelMgr=I
persist.log.tag.RmcCdmaSimUrc=I
persist.log.tag.MtkPhoneNumberUtils=I
persist.log.tag.RmcOemHandler=I
persist.log.tag.RtcModeCont=I
persist.log.tag.MtkPhoneSwitcher=D
persist.log.tag.RIL-Parcel=I
persist.log.tag.RIL-Socket=I
persist.log.tag.RIL-SocListen=I
persist.log.tag.RIL-Netlink=I
persist.log.tag.MwiRIL=I
persist.log.tag.PQ_DS=I
ro.vendor.mtk_data_config=1
vendor.mtk.vdec.waitkeyframeforplay=9
ro.vendor.mtk_embms_support=1
persist.vendor.duraspeed.support=1
ro.lmk.downgrade_pressure=60
persist.vendor.duraspeed.app.on=1
debug.sf.disable_backpressure=1
persist.log.tag.libPowerHal=I
persist.log.tag.mtkpower@impl=I
persist.log.tag.mtkpower_client=I
persist.log.tag.UxUtility=I
persist.log.tag.PowerHalAddressUitls=I
persist.log.tag.PowerHalMgrImpl=I
persist.log.tag.PowerHalMgrServiceImpl=I
persist.log.tag.PowerHalWifiMonitor=I
ro.vendor.mtk_log_hide_gps=0
ro.vendor.mtk_modem_monitor_support=1
ro.vendor.have_aeev_feature=1
ro.vendor.mtk_exchange_support=1
ro.vendor.md_log_memdump_wait=15
ro.vendor.mtk_single_bin_modem_support=1
ro.cp_system_other_odex=1
ro.control_privapp_permissions=enforce
ro.vendor.mtk_camera_app_version=3
persist.vendor.radio.smart.data.switch=1
ro.telephony.iwlan_operation_mode=default
ro.vendor.connsys.dedicated.log=1
ro.vendor.app_resolution_tuner=1
ro.crypto.volume.filenames_mode=aes-256-cts
ro.vendor.mtk.bt_sap_enable=true
persist.vendor.mtk_sim_switch_policy=2
ro.vendor.pref_scale_enable_cfg=1
ro.surface_flinger.primary_display_orientation=ORIENTATION_0
ro.surface_flinger.force_hwc_copy_for_virtual_displays=true
ro.surface_flinger.max_frame_buffer_acquired_buffers=3
persist.vendor.md_c2k_cap_dep_check=0
ro.incremental.enable=yes
ro.config.ringtone=CaribbeanIce.ogg
ro.config.ringtone2=CaribbeanIce.ogg
persist.vendor.cs.fp.chips=3711
persist.vendor.cs.fp.cover=0
persist.vendor.cs.fp.scan_bit=16
persist.vendor.cs.fp.mtp_data=false
persist.vendor.cs.fp.aliyunos=false
persist.vendor.cs.fp.fb_notify_signal=true
persist.vendor.cs.fp.samespace_enroll=false
persist.vendor.cs.fp.repeat_enroll=false
persist.vendor.cs.fp.enroll_count=15
persist.vendor.cs.fp.key_support=true
persist.vendor.cs.fp.navigation=true
persist.vendor.cs.fp.down_up_click=false
persist.vendor.cs.fp.singleclick=true
persist.vendor.cs.fp.doubleclick=true
persist.vendor.cs.fp.longtouch=true
persist.vendor.cs.fp.doubleclick.time=300
persist.vendor.cs.fp.longtouch.time=500
persist.vendor.cs.fp.finger_up_time=80
persist.vendor.cs.fp.open_error_tag=true
persist.vendor.cs.fp.save_sample=true
persist.vendor.cs.cpu.bit=64
persist.vendor.cs.fp.vdd=3.3
persist.vendor.cs.fp.nav.threshold=180
persist.vendor.cs.fp.key.singleclick=87
persist.vendor.cs.fp.key.doubleclick=64
persist.vendor.cs.fp.key.longtouch=63
persist.vendor.cs.fp.key.up=65
persist.vendor.cs.fp.key.down=66
persist.vendor.cs.fp.key.left=67
persist.vendor.cs.fp.key.right=68
persist.vendor.cs.fp.key.down_and_up=189
persist.vendor.cs.fp.nav.angle=180
</pre></div>
</div>
</section>
</section>
<section id="fingerprint">
<h3>fingerprint属性定制<a class="headerlink" href="#fingerprint" title="此标题的永久链接"></a></h3>
<ul class="simple">
<li><p>GMS认证要求如下：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">确保以下三个值完全一致</span>
<span class="n">ro</span><span class="o">.</span><span class="n">vendor</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>
<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>
<span class="n">ro</span><span class="o">.</span><span class="n">bootimage</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>

<span class="n">Build</span> <span class="n">fingerprint</span> <span class="n">必须包含release</span><span class="o">-</span><span class="n">keys</span>
</pre></div>
</div>
<ul class="simple">
<li><p>需要定制的fingerprint属性如下：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ro</span><span class="o">.</span><span class="n">bootimage</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>
<span class="n">ro</span><span class="o">.</span><span class="n">vendor</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>

<span class="n">ro</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>
<span class="n">ro</span><span class="o">.</span><span class="n">odm</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>
<span class="n">ro</span><span class="o">.</span><span class="n">system_ext</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>
<span class="n">ro</span><span class="o">.</span><span class="n">vendor</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>
<span class="n">ro</span><span class="o">.</span><span class="n">product</span><span class="o">.</span><span class="n">build</span><span class="o">.</span><span class="n">fingerprint</span>
</pre></div>
</div>
<ul class="simple">
<li><p>fingerprint属性生成过程<code class="docutils literal notranslate"><span class="pre">build/make/core/Makefile</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>+5623

# The string used to uniquely identify the combined build and product; used by the OTA server.
ifeq (,$(strip $(BUILD_FINGERPRINT)))
  ifeq ($(strip $(HAS_BUILD_NUMBER)),false)
    BF_BUILD_NUMBER := $(BUILD_USERNAME)$$($(DATE_FROM_FILE) +%m%d%H%M)
  else
    BF_BUILD_NUMBER := $(file &lt;$(BUILD_NUMBER_FILE))
  endif
  BUILD_FINGERPRINT := $(PRODUCT_BRAND)/$(TARGET_PRODUCT)/$(TARGET_DEVICE):$(PLATFORM_VERSION)/$(BUILD_ID)/$(BF_BUILD_NUMBER):$(TARGET_BUILD_VARIANT)/$(BUILD_VERSION_TAGS)
endif
# unset it for safety.
BF_BUILD_NUMBER :=

BUILD_FINGERPRINT_FILE := $(PRODUCT_OUT)/build_fingerprint.txt
ifneq (,$(shell mkdir -p $(PRODUCT_OUT) &amp;&amp; echo $(BUILD_FINGERPRINT) &gt;$(BUILD_FINGERPRINT_FILE) &amp;&amp; grep &quot; &quot; $(BUILD_FINGERPRINT_FILE)))
  $(error BUILD_FINGERPRINT cannot contain spaces: &quot;$(file &lt;$(BUILD_FINGERPRINT_FILE))&quot;)
endif
BUILD_FINGERPRINT_FROM_FILE := $$(cat $(BUILD_FINGERPRINT_FILE))
# unset it for safety.
BUILD_FINGERPRINT :=

+559
#$(hide) echo ro.bootimage.build.fingerprint=&quot;$(BUILD_FINGERPRINT_FROM_FILE)&quot;&gt;&gt;$@
</pre></div>
</div>
<p>可以看出来这些属性都是由以下属性构成：</p>
<blockquote>
<div><p>BUILD_FINGERPRINT :=$(PRODUCT_BRAND)/$(TARGET_PRODUCT)/$(TARGET_DEVICE):$(PLATFORM_VERSION)/$BUILD_ID)/$(BF_BUILD_NUMBER):$(TARGET_BUILD_VARIANT)/$(BUILD_VERSION_TAGS)</p>
</div></blockquote>
<p>然后把这个属性写到目录out的<code class="docutils literal notranslate"><span class="pre">build_fingerprint.txt</span></code>文件下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">PAX</span><span class="o">/</span><span class="n">k62v1_64_pax</span><span class="o">/</span><span class="n">k62v1_64_pax</span><span class="p">:</span><span class="mi">11</span><span class="o">/</span><span class="n">RP1A</span><span class="mf">.200720.011</span><span class="o">/</span><span class="n">PayDroid1100BirchV15100</span><span class="p">:</span><span class="n">userdebug</span><span class="o">/</span><span class="n">release</span><span class="o">-</span><span class="n">keys</span>
</pre></div>
</div>
<ul class="simple">
<li><p>属性设置有三个地方，下面是两个地方的：</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>build/make/core/Makefile：
$(hide) echo ro.bootimage.build.fingerprint=&quot;$(BUILD_FINGERPRINT_FROM_FILE)&quot;&gt;&gt;$@

build/make/tools/buildinfo_common.sh：
echo &quot;ro.${partition}.build.fingerprint=$BUILD_FINGERPRINT&quot;
</pre></div>
</div>
<ul class="simple">
<li><p>ro.build.fingerprint属性设置<code class="docutils literal notranslate"><span class="pre">system/core/init/property_service.cpp</span></code>:</p></li>
</ul>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>* PropertyInit();
    * PropertyLoadBootDefaults();
        * property_derive_build_fingerprint();
        
static void property_derive_build_fingerprint() {
    std::string build_fingerprint = GetProperty(&quot;ro.build.fingerprint&quot;, &quot;&quot;);
    if (!build_fingerprint.empty()) {
        return;
    }

    const std::string UNKNOWN = &quot;unknown&quot;;
    build_fingerprint = GetProperty(&quot;ro.product.brand&quot;, UNKNOWN);
    build_fingerprint += &#39;/&#39;;
	//[FEATURE]-Add-BEGIN by (wugangnan@paxsz.com), 2021/05/11, set some fingerprint prop for GMS
    build_fingerprint += GetProperty(&quot;ro.boot.terminal_name&quot;, UNKNOWN);
    build_fingerprint += &#39;/&#39;;
	build_fingerprint += &#39;P&#39;;
	build_fingerprint += &#39;A&#39;;
	build_fingerprint += &#39;Y&#39;;
	build_fingerprint += &#39;P&#39;;
	build_fingerprint += &#39;H&#39;;
	build_fingerprint += &#39;O&#39;;
	build_fingerprint += &#39;N&#39;;
	build_fingerprint += &#39;E&#39;;
    build_fingerprint += GetProperty(&quot;ro.boot.terminal_name&quot;, UNKNOWN);
	if (GetProperty(&quot;ro.paxdroid.name&quot;, UNKNOWN) == &quot;k62v1_64_pax&quot;) {
		build_fingerprint += &#39;_&#39;;
		build_fingerprint += &#39;E&#39;;
		build_fingerprint += &#39;E&#39;;
		build_fingerprint += &#39;A&#39;;
	}
	//[FEATURE]-Add-END by (wugangnan@paxsz.com), 2021/05/11, set some fingerprint prop for GMS
    build_fingerprint += &#39;:&#39;;
    build_fingerprint += GetProperty(&quot;ro.build.version.release&quot;, UNKNOWN);
    build_fingerprint += &#39;/&#39;;
    build_fingerprint += GetProperty(&quot;ro.build.id&quot;, UNKNOWN);
    build_fingerprint += &#39;/&#39;;
    build_fingerprint += GetProperty(&quot;ro.build.version.incremental&quot;, UNKNOWN);
    build_fingerprint += &#39;:&#39;;
    build_fingerprint += GetProperty(&quot;ro.build.type&quot;, UNKNOWN);
    build_fingerprint += &#39;/&#39;;
    build_fingerprint += GetProperty(&quot;ro.build.tags&quot;, UNKNOWN);

    LOG(INFO) &lt;&lt; &quot;Setting property &#39;ro.build.fingerprint&#39; to &#39;&quot; &lt;&lt; build_fingerprint &lt;&lt; &quot;&#39;&quot;;

    std::string error;
    uint32_t res = PropertySet(&quot;ro.build.fingerprint&quot;, build_fingerprint, &amp;error);
	//[FEATURE]-Add-BEGIN by (wugangnan@paxsz.com), 2021/05/11, set some fingerprint prop for GMS
	res = PropertySet(&quot;ro.bootimage.build.fingerprint&quot;, build_fingerprint, &amp;error);
	res = PropertySet(&quot;ro.odm.build.fingerprint&quot;, build_fingerprint, &amp;error);
	res = PropertySet(&quot;ro.system.build.fingerprint&quot;, build_fingerprint, &amp;error);
	res = PropertySet(&quot;ro.system_ext.build.fingerprint&quot;, build_fingerprint, &amp;error);
	res = PropertySet(&quot;ro.vendor.build.fingerprint&quot;, build_fingerprint, &amp;error);
	res = PropertySet(&quot;ro.product.build.fingerprint&quot;, build_fingerprint, &amp;error);
	//[FEATURE]-Add-BEGIN by (wugangnan@paxsz.com), 2021/05/11, set some fingerprint prop for GMS
    if (res != PROP_SUCCESS) {
        LOG(ERROR) &lt;&lt; &quot;Error setting property &#39;ro.build.fingerprint&#39;: err=&quot; &lt;&lt; res &lt;&lt; &quot; (&quot; &lt;&lt; error
                   &lt;&lt; &quot;)&quot;;
    }
}
</pre></div>
</div>
<p>我们知道fingerprint的属性有三个地方，我目前的做法是前两个地方的都不用了，注释掉，将所有属性定义都放在<code class="docutils literal notranslate"><span class="pre">property_derive_build_fingerprint</span></code>中，这样能够灵活的区分是M50还是M8，或者EEA版本还是非EEA版本。</p>
</section>
</section>
<section id="id9">
<h2>总结<a class="headerlink" href="#id9" title="此标题的永久链接"></a></h2>
<p>以下几个prop文件生成方式都是差不多的，这里不再一一叙述，主要是理解怎么生成的，就知道如何去修改。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">system</span><span class="o">/</span><span class="n">system_ext</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">prop</span>
<span class="o">./</span><span class="n">vendor</span><span class="o">/</span><span class="n">odm</span><span class="o">/</span><span class="n">etc</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">prop</span>
<span class="o">./</span><span class="n">product</span><span class="o">/</span><span class="n">build</span><span class="o">.</span><span class="n">prop</span>
</pre></div>
</div>
</section>
</section>


           </div>
             <div class="articleComments">
                <comments>
  <script src="https://utteranc.es/client.js"
    repo="iswbm/magic-python"
    issue-term="pathname"
    theme="github-light"
    crossorigin="anonymous"
    async>
  </script>
</comments>
             </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, wugn.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
  

<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id: "JoV5csIHTGhHiGQ4",ck: "JoV5csIHTGhHiGQ4"})</script>

<br/>
<script id="LA-DATA-WIDGET" crossorigin="anonymous" charset="UTF-8" src="https://v6-widget.51.la/v6/JoV5csIHTGhHiGQ4/quote.js?theme=0&f=12&display=1,0,0,0,0,0,1,1"></script>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>