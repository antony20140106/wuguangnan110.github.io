<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
<title>wugn</title>

      <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
      <link rel="stylesheet" href="../../../_static/default.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../../" id="documentation_options" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/translations.js"></script>
        <script src="../../../_static/js/baidutongji.js"></script>
    <script src="../../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../../genindex.html" />
    <link rel="search" title="搜索" href="../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../index.html" class="icon icon-home"> wugn_note
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">qcom_qcm2290_32go版本编译</a></li>
<li><a class="reference internal" href="#dts">dts编译报错</a></li>
</ul>
</div>
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">wugn_note</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs"> 
<li><a href="../../../index.html" class="icon icon-home"></a> &raquo;</li>
<li>qcom_qcm2290_32go版本编译</li>
<li style="float: right;margin-left: 10px;"><a href="javascript:history.forward()">Forward</a></li>
<li style="float: right;margin-left: 10px;"><a href="javascript:history.back()">Go Back</a> | </li>
<li style="float: right;margin-left: 10px;"><a href="/index.html">Home</a> | </li>

      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="qcom-qcm2290-32go">
<h1>qcom_qcm2290_32go版本编译<a class="headerlink" href="#qcom-qcm2290-32go" title="此标题的永久链接"></a></h1>
<p>高通平台Android 12 Go版本编译问题记录。</p>
</section>
<section id="dts">
<h1>dts编译报错<a class="headerlink" href="#dts" title="此标题的永久链接"></a></h1>
<p>报错如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Copying</span> <span class="n">files</span> <span class="n">to</span> <span class="n">prebuilt</span>
<span class="n">vmlinux</span> <span class="o">/</span><span class="n">ssd</span><span class="o">/</span><span class="n">xiaort</span><span class="o">/</span><span class="n">A665x</span><span class="o">/</span><span class="n">UM</span><span class="mf">.9.15</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="n">ship_prebuilt</span><span class="o">/</span><span class="n">primary_kernel</span>
<span class="n">vmlinux</span> <span class="n">copied</span> <span class="n">to</span> <span class="o">/</span><span class="n">ssd</span><span class="o">/</span><span class="n">xiaort</span><span class="o">/</span><span class="n">A665x</span><span class="o">/</span><span class="n">UM</span><span class="mf">.9.15</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="n">ship_prebuilt</span><span class="o">/</span><span class="n">primary_kernel</span>
<span class="n">System</span><span class="o">.</span><span class="n">map</span> <span class="o">/</span><span class="n">ssd</span><span class="o">/</span><span class="n">xiaort</span><span class="o">/</span><span class="n">A665x</span><span class="o">/</span><span class="n">UM</span><span class="mf">.9.15</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="n">ship_prebuilt</span><span class="o">/</span><span class="n">primary_kernel</span>
<span class="n">System</span><span class="o">.</span><span class="n">map</span> <span class="n">copied</span> <span class="n">to</span> <span class="o">/</span><span class="n">ssd</span><span class="o">/</span><span class="n">xiaort</span><span class="o">/</span><span class="n">A665x</span><span class="o">/</span><span class="n">UM</span><span class="mf">.9.15</span><span class="o">/</span><span class="n">kernel</span><span class="o">/</span><span class="n">ship_prebuilt</span><span class="o">/</span><span class="n">primary_kernel</span>
<span class="o">=============</span>
<span class="n">Copying</span> <span class="n">kernel</span> <span class="n">image</span> <span class="n">to</span> <span class="n">prebuilt</span>
<span class="o">=============</span>
<span class="n">Copying</span> <span class="n">target</span> <span class="n">dtb</span><span class="o">/</span><span class="n">dtbo</span> <span class="n">files</span> <span class="n">to</span> <span class="n">prebuilt</span>
<span class="n">cp</span><span class="p">:</span> <span class="n">bad</span> <span class="s1">&#39;/ssd/xiaort/A665x/UM.9.15/out/target/product/bengal_32go/obj/kernel/msm-4.19/arch/arm/boot/dts/vendor/qcom/*.dtb&#39;</span><span class="p">:</span> <span class="n">No</span> <span class="n">such</span> <span class="n">file</span> <span class="ow">or</span> <span class="n">directory</span>
<span class="n">ninja</span><span class="p">:</span> <span class="n">build</span> <span class="n">stopped</span><span class="p">:</span> <span class="n">subcommand</span> <span class="n">failed</span><span class="o">.</span>
</pre></div>
</div>
<ul class="simple">
<li><p>有以下几点发现：</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">/ssd/xiaort/A665x/UM.9.15/out/target/product/bengal_32go/obj/kernel/msm-4.19/arch/arm/boot/dts/vendor/qcom/</span></code>目录下没有任何dtb编译文件生成。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernel/msm-4.19/arch/arm/boot/dts/vendor/qcom/</span></code>目录下也没有dts文件，只有一个Makefile。</p></li>
<li><p>64位非go版本的dts在<code class="docutils literal notranslate"><span class="pre">kernel/msm-4.19/arch/arm64/boot/dts/vendor/qcom/</span></code>目录下。</p></li>
<li><p>64位非go版本的dts实际上是<code class="docutils literal notranslate"><span class="pre">vendor/qcom/proprietary/devicetree-4.19</span></code>目录下拷贝过来的。</p></li>
</ul>
</li>
</ul>
<p>那我们现在看看64位非go版本的dts是如何进行拷贝的，首先看了编译流程log如下：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">./</span><span class="n">build_32go</span><span class="o">.</span><span class="n">sh</span> <span class="o">--</span><span class="nb">all</span>
<span class="n">including</span> <span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">opensource</span><span class="o">/</span><span class="n">core</span><span class="o">-</span><span class="n">utils</span><span class="o">/</span><span class="n">vendorsetup</span><span class="o">.</span><span class="n">sh</span>
<span class="n">including</span> <span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">proprietary</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">vendorsetup</span><span class="o">.</span><span class="n">sh</span>
<span class="n">including</span> <span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">proprietary</span><span class="o">/</span><span class="n">prebuilt_HY11</span><span class="o">/</span><span class="n">vendorsetup</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<p>当编译执行<code class="docutils literal notranslate"><span class="pre">build/envsetup.sh</span></code>时，会寻找目录下所有的<code class="docutils literal notranslate"><span class="pre">vendorsetup.sh</span></code>并执行。</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="c1"># Execute the contents of any vendorsetup.sh files we can find.</span>
<span class="c1"># Unless we find an allowed-vendorsetup_sh-files file, in which case we&#39;ll only</span>
<span class="c1"># load those.</span>
<span class="c1">#</span>
<span class="c1"># This allows loading only approved vendorsetup.sh files</span>
<span class="k">function</span> source_vendorsetup<span class="o">()</span> <span class="o">{</span>
    <span class="nb">unset</span> VENDOR_PYTHONPATH
    <span class="nv">allowed</span><span class="o">=</span>
    <span class="k">for</span> f <span class="k">in</span> <span class="k">$(</span>find -L device vendor product -maxdepth <span class="m">4</span> -name <span class="s1">&#39;allowed-vendorsetup_sh-files&#39;</span> <span class="m">2</span>&gt;/dev/null <span class="p">|</span> sort<span class="k">)</span><span class="p">;</span> <span class="k">do</span>
        <span class="k">if</span> <span class="o">[</span> -n <span class="s2">&quot;</span><span class="nv">$allowed</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
            <span class="nb">echo</span> <span class="s2">&quot;More than one &#39;allowed_vendorsetup_sh-files&#39; file found, not including any vendorsetup.sh files:&quot;</span>
            <span class="nb">echo</span> <span class="s2">&quot;  </span><span class="nv">$allowed</span><span class="s2">&quot;</span>
            <span class="nb">echo</span> <span class="s2">&quot;  </span><span class="nv">$f</span><span class="s2">&quot;</span>
            <span class="k">return</span>
        <span class="k">fi</span>
        <span class="nv">allowed</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$f</span><span class="s2">&quot;</span>
    <span class="k">done</span>

    <span class="nv">allowed_files</span><span class="o">=</span>
    <span class="o">[</span> -n <span class="s2">&quot;</span><span class="nv">$allowed</span><span class="s2">&quot;</span> <span class="o">]</span> <span class="o">&amp;&amp;</span> <span class="nv">allowed_files</span><span class="o">=</span><span class="k">$(</span>cat <span class="s2">&quot;</span><span class="nv">$allowed</span><span class="s2">&quot;</span><span class="k">)</span>
    <span class="k">for</span> dir <span class="k">in</span> device vendor product<span class="p">;</span> <span class="k">do</span>
        <span class="k">for</span> f <span class="k">in</span> <span class="k">$(</span><span class="nb">test</span> -d <span class="nv">$dir</span> <span class="o">&amp;&amp;</span> <span class="se">\</span>
            find -L <span class="nv">$dir</span> -maxdepth <span class="m">4</span> -name <span class="s1">&#39;vendorsetup.sh&#39;</span> <span class="m">2</span>&gt;/dev/null <span class="p">|</span> sort<span class="k">)</span><span class="p">;</span> <span class="k">do</span>

            <span class="k">if</span> <span class="o">[[</span> -z <span class="s2">&quot;</span><span class="nv">$allowed</span><span class="s2">&quot;</span> <span class="o">||</span> <span class="s2">&quot;</span><span class="nv">$allowed_files</span><span class="s2">&quot;</span> <span class="o">=</span>~ <span class="nv">$f</span> <span class="o">]]</span><span class="p">;</span> <span class="k">then</span>
                <span class="nb">echo</span> <span class="s2">&quot;including </span><span class="nv">$f</span><span class="s2">&quot;</span><span class="p">;</span> . <span class="s2">&quot;</span><span class="nv">$f</span><span class="s2">&quot;</span>
            <span class="k">else</span>
                <span class="nb">echo</span> <span class="s2">&quot;ignoring </span><span class="nv">$f</span><span class="s2">, not in </span><span class="nv">$allowed</span><span class="s2">&quot;</span>
            <span class="k">fi</span>
        <span class="k">done</span>
    <span class="k">done</span>
<span class="o">}</span>

validate_current_shell
source_vendorsetup
addcompletions
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">vendor/qcom/proprietary/prebuilt_HY11/vendorsetup.sh</span></code>看看脚本具体干了什么：</p></li>
</ul>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nv">links_dir</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">&quot;</span>
<span class="nv">links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/links&quot;</span>
<span class="nv">sys_links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/system_links&quot;</span>
<span class="nv">ven_links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/vendor_links&quot;</span>
<span class="nv">kernel_links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/kernel_links&quot;</span>
<span class="nv">display_links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/display_links&quot;</span>
<span class="nv">camera_links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/camera_links&quot;</span>
<span class="nv">video_links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/video_links&quot;</span>
<span class="nv">sensor_links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/sensor_links&quot;</span>
<span class="nv">cv_links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/cv_links&quot;</span>
<span class="nv">audio_links_path</span><span class="o">=</span><span class="s2">&quot;</span><span class="k">$(</span>dirname <span class="k">$(</span>readlink -e <span class="s2">&quot;</span><span class="si">${</span><span class="nv">BASH_SOURCE</span><span class="p">[0]</span><span class="si">}</span><span class="s2">&quot;</span><span class="k">))</span><span class="s2">/audio_links&quot;</span>
<span class="nv">failed_links</span><span class="o">=</span><span class="s2">&quot;&quot;</span>
<span class="nv">count</span><span class="o">=</span><span class="m">0</span>
<span class="k">if</span> <span class="o">[[</span> -f <span class="s2">&quot;</span><span class="nv">$links_path</span><span class="s2">&quot;</span> <span class="o">||</span> -f <span class="s2">&quot;</span><span class="nv">$sys_links_path</span><span class="s2">&quot;</span> <span class="o">||</span> -f <span class="s2">&quot;</span><span class="nv">$ven_links_path</span><span class="s2">&quot;</span> <span class="o">||</span> -f <span class="s2">&quot;</span><span class="nv">$kernel_links_path</span><span class="s2">&quot;</span> <span class="o">||</span> -f <span class="s2">&quot;</span><span class="nv">$display_links_path</span><span class="s2">&quot;</span> <span class="o">||</span> -f <span class="s2">&quot;</span><span class="nv">$camera_links_path</span><span class="s2">&quot;</span> <span class="o">||</span> -f <span class="s2">&quot;</span><span class="nv">$video_links_path</span><span class="s2">&quot;</span> <span class="o">||</span> -f <span class="s2">&quot;</span><span class="nv">$sensor_links_path</span><span class="s2">&quot;</span> <span class="o">||</span> -f <span class="s2">&quot;</span><span class="nv">$cv_links_path</span><span class="s2">&quot;</span> <span class="o">||</span> -f <span class="s2">&quot;</span><span class="nv">$audio_links_path</span><span class="s2">&quot;</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
  <span class="nv">total_links</span><span class="o">=</span><span class="k">$(</span>cat <span class="nv">$links_dir</span>/*links<span class="p">|</span> wc -l<span class="k">)</span>
  <span class="k">for</span> i <span class="k">in</span> <span class="k">$(</span>cat <span class="nv">$links_dir</span>/*links<span class="k">)</span><span class="p">;</span><span class="k">do</span>
    <span class="nv">src</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$i</span> <span class="p">|</span> awk -F:: <span class="s1">&#39;{print $1}&#39;</span><span class="k">)</span>
    <span class="nv">dest</span><span class="o">=</span><span class="k">$(</span><span class="nb">echo</span> <span class="nv">$i</span> <span class="p">|</span> awk -F:: <span class="s1">&#39;{print $2}&#39;</span><span class="k">)</span>
    <span class="k">if</span> <span class="o">[</span> -e <span class="s2">&quot;</span><span class="nv">$dest</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
      <span class="nv">source</span><span class="o">=</span><span class="k">$(</span>readlink  -f <span class="nv">$dest</span><span class="k">)</span>
      <span class="nv">abs_src</span><span class="o">=</span><span class="k">$(</span>readlink  -f <span class="nv">$src</span><span class="k">)</span>
      <span class="k">if</span> <span class="o">[</span> <span class="nv">$source</span> <span class="o">==</span> <span class="nv">$abs_src</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
          <span class="k">continue</span>
      <span class="k">else</span>
          rm -rf <span class="nv">$dest</span>
      <span class="k">fi</span>
    <span class="k">fi</span>
    <span class="k">if</span> <span class="o">[[</span> -e <span class="nv">$src</span> <span class="o">&amp;&amp;</span> ! -e <span class="nv">$dest</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
      mkdir -p <span class="k">$(</span>dirname <span class="nv">$dest</span><span class="k">)</span>
      ln -srf <span class="nv">$src</span> <span class="nv">$dest</span>
      <span class="nv">count</span><span class="o">=</span><span class="k">$((</span><span class="nv">$count</span> <span class="o">+</span> <span class="m">1</span><span class="k">))</span>
    <span class="k">else</span>
      <span class="nv">failed_links</span><span class="o">=</span><span class="s2">&quot;</span><span class="nv">$failed_links</span><span class="s2"> </span><span class="nv">$i</span><span class="s2">&quot;</span>
    <span class="k">fi</span>
  <span class="k">done</span>
  <span class="k">if</span> <span class="o">[</span> ! -z <span class="s2">&quot;</span><span class="nv">$failed_links</span><span class="s2">&quot;</span> <span class="o">]</span><span class="p">;</span><span class="k">then</span>
    <span class="nb">echo</span> <span class="s2">&quot;*****Could not create symlink*******&quot;</span>
    <span class="nb">echo</span> <span class="nv">$failed_links</span> <span class="p">|</span> sed <span class="s1">&#39;s/[[:space:]]/\n/g&#39;</span>
    <span class="nb">echo</span> <span class="s2">&quot;****************END******************&quot;</span>
  <span class="k">fi</span>
  <span class="nb">echo</span> <span class="s2">&quot;Created </span><span class="nv">$count</span><span class="s2"> symlinks out of </span><span class="nv">$total_links</span><span class="s2"> mapped links..&quot;</span>
<span class="k">fi</span>

<span class="c1"># Remove dangling symlinks</span>
<span class="k">if</span> <span class="o">[</span> ! -d ./vendor/qcom/defs <span class="o">]</span><span class="p">;</span> <span class="k">then</span>
    <span class="k">return</span>
<span class="k">fi</span>
<span class="nv">symlinks</span><span class="o">=</span><span class="k">$(</span>find ./vendor/qcom/defs -type l<span class="k">)</span>
<span class="k">for</span> symlink <span class="k">in</span> <span class="nv">$symlinks</span><span class="p">;</span><span class="k">do</span>
<span class="nv">dest_link</span><span class="o">=</span><span class="k">$(</span>readlink -f <span class="nv">$symlink</span><span class="k">)</span>
<span class="k">if</span> <span class="o">[[</span> ! <span class="o">(</span> -f <span class="nv">$dest_link</span> <span class="o">||</span> -d <span class="nv">$dest_link</span> <span class="o">)</span> <span class="o">]]</span><span class="p">;</span><span class="k">then</span>
<span class="nb">echo</span> <span class="s2">&quot;Removing dangling symlink </span><span class="nv">$symlink</span><span class="s2">&quot;</span>
rm -rf  <span class="nv">$symlink</span>
<span class="k">fi</span>
<span class="k">done</span>
</pre></div>
</div>
<p>这里重点关注<code class="docutils literal notranslate"><span class="pre">vendor_links</span></code>文件，这个是具体的软链接配置文件，在路径<code class="docutils literal notranslate"><span class="pre">UM.9.15/vendor/qcom/proprietary/prebuilt_HY11/vendor_links</span></code>下，看看都进行了哪些软链接，前面的是src，<code class="docutils literal notranslate"><span class="pre">::</span></code>后面的是dest，脚本使用命令<code class="docutils literal notranslate"><span class="pre">ln</span> <span class="pre">-srf</span> <span class="pre">$src</span> <span class="pre">$dest</span></code>进行软链接：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">hardware</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">gps</span><span class="o">/</span><span class="n">gps_vendor_product</span><span class="o">.</span><span class="n">mk</span><span class="p">::</span><span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">defs</span><span class="o">/</span><span class="n">product</span><span class="o">-</span><span class="n">defs</span><span class="o">/</span><span class="n">vendor</span><span class="o">/</span><span class="n">gps</span><span class="o">-</span><span class="n">product</span><span class="o">-</span><span class="n">hal</span><span class="o">.</span><span class="n">mk</span>
<span class="n">hardware</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">gps</span><span class="o">/</span><span class="n">gps_vendor_board</span><span class="o">.</span><span class="n">mk</span><span class="p">::</span><span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">defs</span><span class="o">/</span><span class="n">board</span><span class="o">-</span><span class="n">defs</span><span class="o">/</span><span class="n">vendor</span><span class="o">/</span><span class="n">gps</span><span class="o">-</span><span class="n">board</span><span class="o">.</span><span class="n">mk</span>
<span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">opensource</span><span class="o">/</span><span class="n">location</span><span class="o">/</span><span class="n">gps_vendor_product</span><span class="o">.</span><span class="n">mk</span><span class="p">::</span><span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">defs</span><span class="o">/</span><span class="n">product</span><span class="o">-</span><span class="n">defs</span><span class="o">/</span><span class="n">vendor</span><span class="o">/</span><span class="n">gps</span><span class="o">-</span><span class="n">product</span><span class="o">-</span><span class="n">opensource</span><span class="o">.</span><span class="n">mk</span>
<span class="n">vendor</span><span class="o">/</span><span class="n">codeaurora</span><span class="o">/</span><span class="n">packages</span><span class="o">/</span><span class="n">apps</span><span class="o">/</span><span class="n">SnapdragonCamera</span><span class="o">/</span><span class="n">app_snapcam_system_product</span><span class="o">.</span><span class="n">mk</span><span class="p">::</span><span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">defs</span><span class="o">/</span><span class="n">product</span><span class="o">-</span><span class="n">defs</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">app_snapcam_product</span><span class="o">.</span><span class="n">mk</span>
<span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">proprietary</span><span class="o">/</span><span class="n">android</span><span class="o">-</span><span class="n">perf</span><span class="o">/</span><span class="n">configs</span><span class="o">/</span><span class="n">perf</span><span class="o">-</span><span class="n">product</span><span class="o">-</span><span class="n">vendor</span><span class="o">.</span><span class="n">mk</span><span class="p">::</span><span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">defs</span><span class="o">/</span><span class="n">product</span><span class="o">-</span><span class="n">defs</span><span class="o">/</span><span class="n">vendor</span><span class="o">/</span><span class="n">perf</span><span class="o">-</span><span class="n">product</span><span class="o">-</span><span class="n">vendor</span><span class="o">.</span><span class="n">mk</span>
<span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">proprietary</span><span class="o">/</span><span class="n">devicetree</span><span class="o">-</span><span class="mf">4.19</span><span class="o">/../</span><span class="n">devicetree</span><span class="o">-</span><span class="mf">4.19</span><span class="p">::</span><span class="n">kernel</span><span class="o">/</span><span class="n">msm</span><span class="o">-</span><span class="mf">4.19</span><span class="o">/</span><span class="n">arch</span><span class="o">/</span><span class="n">arm64</span><span class="o">/</span><span class="n">boot</span><span class="o">/</span><span class="n">dts</span><span class="o">/</span><span class="n">vendor</span>
<span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">proprietary</span><span class="o">/</span><span class="n">dspservices_ship</span><span class="o">/</span><span class="n">contexthub_system_product</span><span class="o">.</span><span class="n">mk</span><span class="p">::</span><span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">defs</span><span class="o">/</span><span class="n">product</span><span class="o">-</span><span class="n">defs</span><span class="o">/</span><span class="n">system</span><span class="o">/</span><span class="n">contexthub_system_product</span><span class="o">.</span><span class="n">mk</span>
<span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">proprietary</span><span class="o">/</span><span class="n">dspservices_ship</span><span class="o">/</span><span class="n">dspservices_vendor_product</span><span class="o">.</span><span class="n">mk</span><span class="p">::</span><span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">defs</span><span class="o">/</span><span class="n">product</span><span class="o">-</span><span class="n">defs</span><span class="o">/</span><span class="n">vendor</span><span class="o">/</span><span class="n">dspservices_vendor_product</span><span class="o">.</span><span class="n">mk</span>
<span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">proprietary</span><span class="o">/</span><span class="n">dspservices_ship</span><span class="o">/</span><span class="n">chre_system_product</span><span class="o">.</span><span class="n">mk</span><span class="p">::</span><span class="n">vendor</span><span class="o">/</span><span class="n">qcom</span><span class="o">/</span><span class="n">defs</span><span class="o">/</span><span class="n">product</span><span class="o">-</span><span class="n">defs</span><span class="o">/</span><span class="n">vendor</span><span class="o">/</span><span class="n">chre_system_product</span><span class="o">.</span><span class="n">mk</span>
</pre></div>
</div>
<p>发现32位kernel下面并没有将dts软链接过去，手动加一下编译通过：</p>
<div class="highlight-diff notranslate"><div class="highlight"><pre><span></span><span class="gd">--- a/UM.9.15/vendor/qcom/proprietary/prebuilt_HY11/vendor_links</span><span class="w"></span>
<span class="gi">+++ b/UM.9.15/vendor/qcom/proprietary/prebuilt_HY11/vendor_links</span><span class="w"></span>
<span class="gu">@@ -60,6 +60,7 @@ vendor/qcom/opensource/location/gps_vendor_product.mk::vendor/qcom/defs/product-</span><span class="w"></span>
<span class="w"> </span>vendor/codeaurora/packages/apps/SnapdragonCamera/app_snapcam_system_product.mk::vendor/qcom/defs/product-defs/system/app_snapcam_product.mk<span class="w"></span>
<span class="w"> </span>vendor/qcom/proprietary/android-perf/configs/perf-product-vendor.mk::vendor/qcom/defs/product-defs/vendor/perf-product-vendor.mk<span class="w"></span>
<span class="w"> </span>vendor/qcom/proprietary/devicetree-4.19/../devicetree-4.19::kernel/msm-4.19/arch/arm64/boot/dts/vendor<span class="w"></span>
<span class="gi">+vendor/qcom/proprietary/devicetree-4.19/../devicetree-4.19::kernel/msm-4.19/arch/arm/boot/dts/vendor</span><span class="w"></span>
<span class="w"> </span>vendor/qcom/proprietary/dspservices_ship/contexthub_system_product.mk::vendor/qcom/defs/product-defs/system/contexthub_system_product.mk<span class="w"></span>
<span class="w"> </span>vendor/qcom/proprietary/dspservices_ship/dspservices_vendor_product.mk::vendor/qcom/defs/product-defs/vendor/dspservices_vendor_product.mk<span class="w"></span>
<span class="w"> </span>vendor/qcom/proprietary/dspservices_ship/chre_system_product.mk::vendor/qcom/defs/product-defs/vendor/chre_system_product.mk<span class="w"></span>
</pre></div>
</div>
</section>


           </div>
         <div class="articleComments">
               <comments>
  <script src="https://utteranc.es/client.js"
    repo="iswbm/magic-python"
    issue-term="pathname"
    theme="github-light"
    crossorigin="anonymous"
    async>
  </script>
</comments>
           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, wugn.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
  

<script charset="UTF-8" id="LA_COLLECT" src="//sdk.51.la/js-sdk-pro.min.js"></script>
<script>LA.init({id: "JoV5csIHTGhHiGQ4",ck: "JoV5csIHTGhHiGQ4"})</script>

<br/>
<script id="LA-DATA-WIDGET" crossorigin="anonymous" charset="UTF-8" src="https://v6-widget.51.la/v6/JoV5csIHTGhHiGQ4/quote.js?theme=#4C8AC2,#BB2626,#040000,#333333,#AE3535,#1690FF,14&f=14"></script>



</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>