# å¸¸ç”¨gitæ“ä½œæ±‡æ€»

æ€»ç»“ä»¥ä¸‹å¸¸ç”¨çš„gitå‘½ä»¤

# cherry-pickæŠ€å·§

* git cherry-pick <commit id>:å•ç‹¬åˆå¹¶ä¸€ä¸ªæäº¤
* git cherry-pick -x <commit id>ï¼šåŒä¸Šï¼Œä¸åŒç‚¹ï¼šä¿ç•™åŸæäº¤è€…ä¿¡æ¯ã€‚
* å¦‚æœæœ‰100ä¸ªcommitè¦åˆå¹¶åˆ°masteråˆ†æ”¯å‘¢ï¼Ÿ
* git cherry-pick commit1..commit100

ä½†æ˜¯è¦æ³¨æ„ï¼Œè¿™æ˜¯ä¸€ä¸ªå·¦å¼€å³é—­çš„æ“ä½œï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œcommit1ä¸ä¼šè¢«åˆå¹¶åˆ°masteråˆ†æ”¯ï¼Œè€Œcommit100åˆ™ä¼šã€‚è¿™æ ·çš„è¯ä¸Šé¢çš„éœ€æ±‚å¯ä»¥å¦‚ä¸‹æ“ä½œæ¥å®ç°ï¼š

æ³¨æ„ï¼šä¸Šé¢è®²åˆ°cherry-pickå‘½ä»¤æ¯æ‹£é€‰ä¸€ä¸ªcommitå°±ä¼šæäº¤ä¸€æ¬¡ç”Ÿæˆä¸€ä¸ªæ–°çš„commit idã€‚ å¦‚æœæˆ‘ä»¬æƒ³è®©æ¯ä¸ªcommit æ‹£é€‰åæš‚ç¼“æäº¤ï¼Œç­‰åˆ°æ‰€æœ‰commitéƒ½æ‹£é€‰å®Œæˆåï¼Œè‡ªå·±æ‰‹åŠ¨commitï¼Œåº”è¯¥æ€ä¹ˆåŠå‘¢ï¼Ÿç­”æ¡ˆæ˜¯ç”¨-n é€‰é¡¹ã€‚

# cherry-pickæŒ‘é€‰ä¸­é—´å‡ ä¸ª

* [notepad++ å»æ‰åŒ…å«æŸä¸ªå­—ç¬¦ä¸²çš„æ‰€æœ‰è¡Œ](https://www.cnblogs.com/czp2016/p/15661741.html)
* [Notepad++å¸¸ç”¨æ“ä½œâ€”â€”å»é™¤æ¯è¡ŒæŸå­—ç¬¦ä¸²åé¢çš„å†…å®¹](https://blog.csdn.net/qq_38516799/article/details/105371700)

* git log --oneline -100 origin/pax_branch

![0001_0013.png](images/0001_0013.png)

* éœ€è¦ä½¿ç”¨æ­£åˆ™`^.*åˆå¹¶åˆ†æ”¯.*\r?\n`åˆ é™¤åˆå¹¶é€‰é¡¹ï¼š

![0001_0014.png](images/0001_0014.png)

* æ­£åˆ™`Title.*`å»é™¤æ¯è¡Œ`Title`å­—ç¬¦ä¸²åé¢çš„å†…å®¹:

![0001_0015.png](images/0001_0015.png)

* ä½¿ç”¨notepadåˆå¹¶è¡ŒåŠŸèƒ½ï¼Œå¤šåˆ—å˜ä¸€è¡Œï¼š

![0001_0016.png](images/0001_0016.png)

* å‡ºç°åˆå¹¶å†²çªï¼š
```shell
wugn@jcrj-tf-compile:M8-project$ git cherry-pick 0619b9a1654 693bcfccc52 3dbcb58221f 6b8e1012aae d9d538d2852 aad224920b0 48d3db20ff2 f30f9b88cdc c9c8d4a6736 b62fd77488a 59811608877 558424e8ce5 f9e3f4f015d a78cca900c9 723c5811ab0 dc823540baa d10b540b41d 11a79046a42 a1f792ce6d1 e781c6b2cc8 c5e6bef5831 7e951688844 389c6ee8f66 7a5f76e3b0c f5864341155 f0189c741f1 41934ce1e44 113e1273d34 3fc18a796db a651ea18092 9d8e72917bd 46dd0ae98ad d8e434500d4 6f0170c5bbf f24becdfd76 06337f7555d 15a34dfefdb 62ac5854c48 9e826c0f828 df11ef34c56 f359de847cc 139d935a070 0ff1dd457f6 3de6d57bd68 65e28e7f8d6 29e38a3ef22 32c69782cfc e415b98a9b6

Performing inexact rename detection: 100% (1188/1188), done.
error: could not apply 0619b9a1654... [Title]:Optimize:edmåœ¨æ³¨å…¥rkiæ—¶å€™å¢åŠ åŒæ­¥æ—¶é—´çš„æ¥å£
hint: after resolving the conflicts, mark the corrected paths
hint: with 'git add <paths>' or 'git rm <paths>'
hint: and commit the result with 'git commit'
```

* git diff :
```diff
--- a/paxdroid/packages/apps/edm/Android.mk
+++ b/paxdroid/packages/apps/edm/Android.mk
@@@ -7,7 -7,7 +7,11 @@@ LOCAL_MODULE_SUFFIX := $(COMMON_ANDROID
  #LOCAL_PRIVILEGED_MODULE :=
  LOCAL_PRODUCT_MODULE := true
  LOCAL_CERTIFICATE := platform
++<<<<<<< HEAD
 +LOCAL_SRC_FILES := EDM_V2.00.00_20220809_release.apk
++=======
+ LOCAL_SRC_FILES := EDM_V2.00.00_20221024_release.apk
++>>>>>>> 0619b9a1654... [Title]:Optimize:edmåœ¨æ³¨å…¥rkiæ—¶å€™å¢åŠ åŒæ­¥æ—¶é—´çš„æ¥å£
  LOCAL_MODULE_PATH := $(TARGET_OUT_VENDOR)/operator/app
  LOCAL_DEX_PREOPT := false
  #LOCAL_REQUIRED_MODULES :=
* Unmerged path paxdroid/packages/apps/edm/EDM_V2.00.00_20220809_release.apk
* Unmerged path paxdroid/packages/apps/edm/EDM_V2.00.00_20220923_release.apk
* Unmerged path paxdroid/packages/apps/edm/EDM_V2.00.00_20221024_release.apk

```

* è§£å†³ç¬¬ä¸€ä¸ªå†²çªåæ·»åŠ ï¼š
```
wugn@jcrj-tf-compile:M8-project$ rm paxdroid/packages/apps/edm/EDM_V2.00.00_20220809_release.apk
wugn@jcrj-tf-compile:M8-project$ rm paxdroid/packages/apps/edm/EDM_V2.00.00_20220923_release.apk
git add paxdroid/packages/apps/edm
```

* git commit:
```shell
wugn@jcrj-tf-compile:M8-project$ git commit
[product e7c56eaa002] [Title]:Optimize:edmåœ¨æ³¨å…¥rkiæ—¶å€™å¢åŠ åŒæ­¥æ—¶é—´çš„æ¥å£
 Author: lib <lib@paxsz.com>
 Date: Mon Oct 24 23:37:33 2022 +0800
 4 files changed, 1 insertion(+), 1 deletion(-)
 rename paxdroid/packages/apps/edm/{EDM_V2.00.00_20220809_release.apk => EDM_V2.00.00_20221024_release.apk} (88%)
 create mode 100755 paxdroid/packages/apps/edm/EDM_V2.00.00_20221026_release.apk
 create mode 100755 paxdroid/packages/apps/edm/edmsource/common_lib/libs/libusbmonitor_20221022094026.jar
```

* git cherry-pick --continue:
```
wugn@jcrj-tf-compile:M8-project$ git cherry-pick --continue
[product 4de6948cd26] [Title]:EEAç‰ˆæœ¬ç¼–è¯‘OTAåŒ…æ—¶åŒ…å«eeaç‰ˆæœ¬keyã€‚
 Date: Mon Oct 24 12:37:36 2022 +0800
 2 files changed, 28 insertions(+)
error: could not apply 3dbcb58221f... [Title]:å°†preloaderå’Œteeé•œåƒä¸åšpaydroid toolå‡çº§ã€‚
hint: after resolving the conflicts, mark the corrected paths
hint: with 'git add <paths>' or 'git rm <paths>'
hint: and commit the result with 'git commit'

wugn@jcrj-tf-compile:M8-project$ vim vendor/mediatek/proprietary/buildinfo_vnd/label.ini
wugn@jcrj-tf-compile:M8-project$ vim vendor/mediatek/proprietary/buildinfo_vnd/label_eea.ini
wugn@jcrj-tf-compile:M8-project$ git add vendor/mediatek/proprietary/buildinfo_vnd
wugn@jcrj-tf-compile:M8-project$ git commit
[product 73f6417b816] [Title]:å°†preloaderå’Œteeé•œåƒä¸åšpaydroid toolå‡çº§ã€‚
 Date: Sat Oct 22 16:31:03 2022 +0800
 11 files changed, 40 insertions(+), 12 deletions(-)
 create mode 100755 selfbuild_modem
```

ä¸€ä¸ªä¸€ä¸ªçš„ä¿®æ”¹å°±å¥½äº†ã€‚

# å¤šä¸ªgité¡¹ç›®åº“ä¹‹é—´çš„cherry-pickæ“ä½œ

* [å¤šä¸ªgité¡¹ç›®åº“ä¹‹é—´çš„cherry-pickæ“ä½œ](https://blog.csdn.net/qq_40102178/article/details/123378200)

* ç›®çš„ï¼šç›®çš„ï¼šæŠŠAåº“masteråˆ†æ”¯çš„æŸæ¬¡æäº¤commit id æäº¤åˆ° Båº“pax_gms_branch_m9200åˆ†æ”¯

ä»gitä¸Šçš„Aåº“ fork åˆ° Båº“ï¼Œç„¶åAåº“å’ŒBåº“è¿›è¡Œç‹¬è‡ªçš„å¼€å‘ã€‚å¼€å‘ä¸­ä¹Ÿä¼šé‡åˆ°ä¸€äº›é—®é¢˜ï¼Œä¾‹å¦‚Aåº“æœ‰é‡è¦çš„ä»£ç ä¿®å¤ï¼Œè€åŠæ³•æ˜¯å†å»Båº“ä¿®æ”¹ä¸€æ¬¡ï¼Œæ“ä½œèµ·æ¥ä¸å¤ªæ–¹ä¾¿ã€‚è¿™é‡Œå°±å°è¯•ä»å¤šä¸ªä¸åŒgitåº“ä¸­è¿›è¡Œcherry-pickã€‚

* Båº“ï¼š åœ¨æœ¬åœ°æ·»åŠ å¦ä¸€ä¸ªAåº“
```
git remote add devorigin git@172.16.2.83:sc200e/A6650-project.git
```

* `git remote -v`Båº“ï¼š é€šè¿‡ git remote -v æŸ¥çœ‹æ˜¯å¦æ·»åŠ æˆåŠŸ:

![0001_0017.png](images/0001_0017.png)

* Båº“ï¼š é€šè¿‡ git fetch devorigin å°†Aåº“çš„è¯¥åˆ†æ”¯ä¿¡æ¯åŒæ­¥åˆ°æœ¬åœ°

* Båº“ï¼š é€šè¿‡`git log devorigin/gms_branch_m9200`è·å–Aåº“gms_branch_m9200åˆ†æ”¯æäº¤ã€‚

* å®Œæˆ fetch å°±å·²ç»å¯ä»¥å¼€å§‹cherry-pickæ“ä½œäº†,Båº“:
```
git cherry-pick fa25a2a43d3f82870b68883645fd7442412ab40c(é¦–)..bff5dcedbb046aeb30ad070632e3d7bd8d5690b9
```

# git stash

å¦‚æœæˆ‘ä»¬ä¸æƒ³æäº¤å®Œæˆä¸€åŠæˆ–è€…ä¸å®Œå–„çš„ä»£ç ï¼Œä½†æ˜¯å´ä¸å¾—ä¸å»ä¿®æ”¹ä¸€ä¸ªç´§æ€¥Bugï¼Œé‚£ä¹ˆä½¿ç”¨git stashå°±å¯ä»¥å°†ä½ å½“å‰æœªæäº¤åˆ°æœ¬åœ°ï¼ˆå’ŒæœåŠ¡å™¨ï¼‰çš„ä»£ç æ¨å…¥åˆ°Gitçš„æ ˆä¸­ï¼Œè¿™æ—¶å€™ä½ çš„å·¥ä½œåŒºé—´å’Œä¸Šä¸€æ¬¡æäº¤çš„å†…å®¹æ˜¯å®Œå…¨ä¸€æ ·çš„ï¼Œæ‰€ä»¥ä½ å¯ä»¥æ”¾å¿ƒçš„ä¿®Bugï¼Œç­‰åˆ°ä¿®å®ŒBugï¼Œæäº¤åˆ°æœåŠ¡å™¨ä¸Šåï¼Œå†ä½¿ç”¨git stash popå°†ä»¥å‰ä¸€åŠçš„å·¥ä½œåº”ç”¨å›æ¥ã€‚git stashå‘½ä»¤æŠŠæœªæäº¤çš„ä¿®æ”¹å‚¨å­˜èµ·æ¥ï¼Œç”¨äºåç»­çš„æ¢å¤,è®°ä½ä¸èƒ½æ‰§è¡Œgit commit

git stash [save 'message']ï¼š git stashç”¨äºä¿å­˜ä¸ºæäº¤çš„ä¿®æ”¹ï¼Œå·²ç»commitçš„ä¸é€‚ç”¨äº†ï¼ŒåŠ ä¸€ä¸ªsaveå¯ä»¥æ·»åŠ å¤‡æ³¨ä¿¡æ¯ï¼Œç”¨äºè®°å½•ç‰ˆæœ¬ã€‚
git stash listï¼šæŸ¥çœ‹æ‰€æœ‰çš„stashã€‚
git stash show ï¼šæ˜¾ç¤ºåšäº†å“ªäº›æ”¹åŠ¨ï¼Œé»˜è®¤showç¬¬ä¸€ä¸ªå­˜å‚¨,å¦‚æœè¦æ˜¾ç¤ºå…¶ä»–å­˜å‚¨ï¼Œåé¢åŠ stash idï¼Œæ¯”å¦‚ç¬¬äºŒä¸ª git stash show stash@{1}ï¼Œå®Œæ•´çš„å·®å¼‚å¯ä»¥ä½¿ç”¨git stash show -pã€‚
git stash popï¼šå°†stashç¼“å­˜å †æ ˆä¸­ç¬¬ä¸€ä¸ªstashä¹Ÿå°±æ˜¯stash@{0}åˆ é™¤ï¼Œå¹¶å°†å¯¹åº”ä¿®æ”¹åº”ç”¨åˆ°å½“å‰çš„å·¥ä½œç›®å½•ä¸‹ã€‚
git stash apply:  å°†stashç¼“å­˜å †æ ˆä¸­ç¬¬ä¸€ä¸ªstashåº”ç”¨åˆ°å½“å‰çš„å·¥ä½œç›®å½•ä¸‹ï¼Œä½†æ˜¯ä¸ä¼šåˆ é™¤ç¼“å­˜å †æ ˆä¸­çš„ç¼“å­˜ï¼Œé»˜è®¤ä½¿ç”¨ç¬¬ä¸€ä¸ªå­˜å‚¨,å³stash@{0}ï¼Œåº”ç”¨æŸä¸ªstashåé¢åŠ stash idã€‚
git stash drop stash@{$num} ï¼šåˆ é™¤stash@{$num}å­˜å‚¨ï¼Œä»åˆ—è¡¨ä¸­åˆ é™¤è¿™ä¸ªå­˜å‚¨ï¼Œé»˜è®¤åˆ é™¤ç¬¬ä¸€ä¸ªã€‚
git stash clear:  åˆ é™¤ç¼“å­˜å †æ ˆä¸­æ‰€æœ‰å­˜å‚¨ã€‚

# git cleanä½¿ç”¨æ€»ç»“

git cleanç§»é™¤å·¥ä½œåŒºä¸­untrackedçš„æ–‡ä»¶(å³ï¼šéœ€è¦å…ˆadd)ã€‚ä¸€ç›´éƒ½æ˜¯ç”¨rmæ¥æ“ä½œâ€¦â€¦ğŸ˜“

1ã€git clean -nï¼šåˆ—å‡ºä¼šè¢«åˆ é™¤çš„æ–‡ä»¶ï¼Œæœªåˆ é™¤

2ã€git clean -fï¼šforce, æ‰§è¡Œåˆ é™¤ï¼Œä¸ä¼šåˆ é™¤.gitignoreä¸­æŒ‡å®šçš„æ–‡ä»¶ï¼Œclean.requireForceè®¾ç½®ä¸ºfalseå¯ä¸ç”¨å¸¦-fï¼Œç›´æ¥ä½¿ç”¨git cleanã€‚

3ã€git clean -f <path>ï¼šåˆ é™¤æŒ‡å®šè·¯å¾„çš„æ–‡ä»¶

4ã€git clean -dfï¼šåˆ é™¤æ–‡ä»¶å’Œç›®å½•

5ã€git clean -xfï¼šè¿.gitignoreä¸­æŒ‡å®šçš„æ–‡ä»¶ä¸€èµ·åˆ é™¤

# git diffåŸç†

æŒæ¡git diffå‘½ä»¤çš„é‡ç‚¹åœ¨äºï¼Œæ˜ç™½Gitæ–‡ä»¶çš„å››ç§çŠ¶æ€ï¼Œä»¥åŠæ–‡ä»¶çš„æ‰€åœ¨åŒºåŸŸã€‚
æ–‡ä»¶æ‰€åœ¨çš„åŒºåŸŸæœ‰ä¸‰ä¸ªï¼šå·¥ä½œåŒºã€æš‚å­˜åŒºã€ä»“åº“ã€‚ 
æ–‡ä»¶çš„æµè½¬æ–¹å‘æ˜¯ç”±å·¥ä½œåŒºåˆ›å»ºï¼Œaddè¿›å…¥æš‚å­˜åŒºï¼Œcommitè¿›å…¥ä»“åº“ã€‚
git diffçš„æ¯”è¾ƒæ˜¯ä»å³å‘å·¦ã€‚
git diff æ¯”è¾ƒæš‚å­˜åŒºä¸å·¥ä½œåŒºæ–‡ä»¶çš„åŒºåˆ«ã€‚
git diff --cached æ¯”è¾ƒä»“åº“ä¸æš‚å­˜åŒºæ–‡ä»¶çš„åŒºåˆ«ã€‚